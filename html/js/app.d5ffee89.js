(function(e){function t(t){for(var n,r,l=t[0],i=t[1],c=t[2],d=0,h=[];d<l.length;d++)r=l[d],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&h.push(s[r][0]),s[r]=0;for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n]);u&&u(t);while(h.length)h.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],n=!0,r=1;r<a.length;r++){var i=a[r];0!==s[i]&&(n=!1)}n&&(o.splice(t--,1),e=l(l.s=a[0]))}return e}var n={},s={app:0},o=[];function r(e){return l.p+"js/"+({about:"about"}[e]||e)+"."+{about:"dd8d9938"}[e]+".js"}function l(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,l),a.l=!0,a.exports}l.e=function(e){var t=[],a=s[e];if(0!==a)if(a)t.push(a[2]);else{var n=new Promise((function(t,n){a=s[e]=[t,n]}));t.push(a[2]=n);var o,i=document.createElement("script");i.charset="utf-8",i.timeout=120,l.nc&&i.setAttribute("nonce",l.nc),i.src=r(e);var c=new Error;o=function(t){i.onerror=i.onload=null,clearTimeout(d);var a=s[e];if(0!==a){if(a){var n=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+n+": "+o+")",c.name="ChunkLoadError",c.type=n,c.request=o,a[1](c)}s[e]=void 0}};var d=setTimeout((function(){o({type:"timeout",target:i})}),12e4);i.onerror=i.onload=o,document.head.appendChild(i)}return Promise.all(t)},l.m=e,l.c=n,l.d=function(e,t,a){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(l.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)l.d(a,n,function(t){return e[t]}.bind(null,n));return a},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/",l.oe=function(e){throw console.error(e),e};var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var d=0;d<i.length;d++)t(i[d]);var u=c;o.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"1f3e":function(e,t,a){"use strict";var n=a("fb50"),s=a.n(n);s.a},"56d7":function(e,t,a){"use strict";a.r(t),a.d(t,"EventBus",(function(){return Pe}));a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",[a("v-app-bar",{attrs:{app:"","clipped-left":"","clipped-right":""}},[a("v-app-bar-nav-icon",{attrs:{disabled:"",_click:"drawer = !drawer"}}),a("v-toolbar-title",[e._v("Dashboard")]),a("v-spacer"),a("v-badge",e._b({attrs:{content:e.alertCount,dot:e.hideAlertBadge,color:"error",left:"",_overlap:"","offset-x":"23","offset-y":"23"}},"v-badge",e.alertBadgeIconProp,!1),[a("v-btn",{attrs:{icon:""},on:{click:e.openAlertSheet}},[a("v-icon",[e._v("mdi-bell")])],1)],1),a("v-tooltip",{attrs:{bottom:"","open-delay":1e3},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-btn",e._g(e._b({attrs:{icon:""},on:{click:e.changeDarkMode}},"v-btn",s,!1),n),[a("v-icon",[e._v("mdi-theme-light-dark")])],1)]}}])},[a("span",[e._v("Switch to day/night mode")])]),a("v-btn",{attrs:{icon:""},on:{click:function(t){e.showSettingDialog=!0}}},[a("v-icon",[e._v("mdi-cog")])],1)],1),a("v-main",[e.socketConnected?e._e():a("v-banner",{attrs:{app:"","single-line":"",_color:"white",icon:"mdi-wifi-strength-alert-outline","icon-color":"red"},scopedSlots:e._u([{key:"actions",fn:function(){return[a("v-btn",{attrs:{text:"",color:"primary",loading:e.btnSocketReconnectLoading,disabled:e.btnSocketReconnectLoading},on:{click:e.reconnectSocket}},[e._v(" Reconnect ")])]},proxy:!0}],null,!1,2500245156)},[e._v(" Lost socket connection to API Server ")]),a("v-container",{attrs:{fluid:""}},[e.skeletonLoading?a("v-row",e._l(9,(function(e){return a("v-col",{key:e,attrs:{cols:"12",lg:"3"}},[a("v-skeleton-loader",{staticClass:"mx-auto",attrs:{_loading:"skeletonLoading",transition:"scale-transition","max-width":"300",type:"card"}})],1)})),1):0==e.hostsReport.length?a("v-row",[a("v-col",[e.apiError?e.socketConnected?a("v-alert",{attrs:{text:"",color:"info",border:"left"}},[a("div",[e._v("Please waiting for the first report being aggregated at CentMonit...")])]):a("v-alert",{attrs:{text:"",color:"error",border:"left"}},[a("h3",{staticClass:"headline"},[e._v(e._s(e.apiErrorMessage))]),a("div",[e._v(" Is CentMonit daemon process running normally on the server side (at address "+e._s(""+this.$GCONFIG.api_base_url)+")?"),a("br"),e._v(" Try restart it then reload your browser (Ctrl + F5). ")])]):a("v-alert",{attrs:{text:"",color:"info",border:"left"}},[a("h3",{staticClass:"headline"},[e._v("No data found")]),a("div",[e._v(" You may need to wait for CentMonit to receive first report data from Monit agents."),a("br"),e._v(" If you've waited so long, then check your Monit log (/var/log/monit.log) to see whether it successfully send report data to CentMonit?"),a("br"),e._v(" Please follow the setup manual from installation folder to verify Monit and CentMonit's configuration. ")])])],1)],1):a("div",[a("v-row",{staticClass:"justify-center"},[a("div",{class:[e.lastReportTimeStyleClass],staticStyle:{color:"#2196F3"}},[a("span",{staticClass:"text-lowercase text-caption"},[e._v("Healthy hosts")]),e._v(" "),a("span",{staticClass:"text-subtitle-2"},[e._v(e._s(e.totalGoodHosts())+"/"+e._s(Object.keys(e.hostsState).length))]),e._v(" - "),a("span",{staticClass:"text-lowercase text-caption"},[e._v("Last report")]),e._v(" "),a("span",{staticClass:"text-subtitle-2"},[e._v(e._s(e.lastHostsReportTime.toLocaleString()))])])]),a("v-row",e._l(e.hostsReport,(function(t,n){return a("v-col",{key:n+"-"+t.alertMessage,attrs:{_key:"index",cols:"12",_sm:"6",md:"6",lg:"4"}},[a("HostCard",{attrs:{report:t},on:{hostStateChanged:e.onHostStateChanged}})],1)})),1)],1),a("v-bottom-sheet",{staticStyle:{"overflow-y":"scroll"},model:{value:e.alertSheet,callback:function(t){e.alertSheet=t},expression:"alertSheet"}},[a("v-card",[a("v-card-title",{attrs:{_class:"justify-center"}},[a("span",{staticClass:"text-subtitle-1"},[e._v("Realtime Channel")]),a("v-icon",[e._v("mdi-circle-small")]),a("span",{class:[e.socketStatusStyleClass]},[e._v(e._s(e.socketConnectionStatusDesc))]),a("v-spacer"),a("v-tooltip",{attrs:{bottom:"","open-delay":1e3},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-btn",e._g(e._b({attrs:{icon:""},on:{click:e.alertReset}},"v-btn",s,!1),n),[a("v-icon",[e._v("mdi-notification-clear-all")])],1)]}}])},[a("span",[e._v("Clear all messages (old messages will be removed automatically)")])]),a("v-btn",{attrs:{icon:""},on:{click:function(t){e.alertSheet=!e.alertSheet}}},[a("v-icon",[e._v("mdi-chevron-down")])],1)],1),a("v-divider"),a("v-card-text",{staticClass:"pt-4",staticStyle:{height:"80vh","overflow-y":"scroll"}},[e.socketConnected?e._e():a("div",{staticClass:"text-center"},[a("v-btn",{staticClass:"mb-2",attrs:{loading:e.btnSocketReconnectLoading,disabled:e.btnSocketReconnectLoading,outlined:"",color:"primary"},on:{click:e.reconnectSocket}},[e._v(" Reconnect "),a("v-icon",{attrs:{right:""}},[e._v("mdi-sync")])],1)],1),e._l(e.alert_messages,(function(t,n){return a("v-alert",{key:n,attrs:{border:"left","colored-border":"",color:e.getAlertColor(t.type),elevation:"1"}},[Boolean(t.host)?a("span",{staticClass:"text-subtile-1 font-weight-bold"},[e._v(" "+e._s(t.host)+" "),Boolean(t.service)?[a("v-icon",{attrs:{small:""}},[e._v("mdi-circle-small")]),e._v(" "+e._s(t.service)+" ")]:e._e(),a("br")],2):e._e(),a("span",{staticClass:"text-caption"},[a("v-icon",{attrs:{small:""}},[e._v("mdi-calendar-clock")]),e._v(" "+e._s(t.time.toLocaleString())),a("br")],1),Boolean(t.serviceTypeDesc)?a("span",{staticClass:"text-caption"},[a("v-icon",{attrs:{small:""}},[e._v("mdi-tag-text-outline")]),e._v(" "+e._s(t.serviceTypeDesc)),a("br")],1):e._e(),a("div",{staticClass:"mt-1"},[e._v(" "+e._s(t.message)+" ")])])}))],2)],1)],1),e.showSettingDialog?a("Setting",{on:{closeDialog:function(t){e.showSettingDialog=!1}}}):e._e()],1)],1),a("v-footer",{attrs:{app:"",_class:"grey _dark_en-3 white--text"}},[a("div",{staticClass:"text-caption",attrs:{_class:"ml-3 text-caption text-sm-body-2"}},[e._v(" Made with "),a("v-icon",{staticClass:"red--text",staticStyle:{"vertical-align":"middle"},attrs:{small:""}},[e._v("mdi-heart-outline")]),e._v(" by "),a("a",{attrs:{_class:"white--text",href:"https://vuetifyjs.com",target:"_blank"}},[e._v("Vuetify")])],1),a("v-spacer"),a("div",{staticClass:"font-italic caption",attrs:{_class:"mr-3 hidden-xs-only"}},[e._v(" Version "+e._s(e.APP_VERSION)+" ")])],1)],1)},o=[],r=(a("4de4"),a("4160"),a("b64b"),a("d3b7"),a("159b"),a("5530")),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",{staticClass:"mx-auto",attrs:{"max-width":"350","min-height":"206",_click:"test"}},[a("v-list-item",{attrs:{"_three-line":""}},[a("v-list-item-avatar",[a("v-icon",{class:"mdi-loading"===e.hostLedDesc[1]?"mdi-spin":"",attrs:{color:e.hostLedDesc[0]}},[e._v(e._s(e.hostLedDesc[1]))])],1),a("v-list-item-content",[a("v-list-item-title",{staticClass:"text-subtile-1 font-weight-bold"},[e._v(" "+e._s(e.report.hostname)+" ")]),a("v-list-item-subtitle",{staticClass:"text-caption"},[a("span",[e._v(e._s(e.uptimeDesc)+" monit up")]),a("v-icon",{attrs:{small:""}},[e._v("mdi-circle-small")]),a("span",[e._v(e._s(e.pollTimeDesc)+" poll-cycle")])],1)],1)],1),a("v-card-text",[e.report.alertMessage?a("v-row",{staticClass:"text-center"},[a("v-col",{attrs:{cols:"12"}},[a("div",[e._v(e._s(e.report.alertMessage))])])],1):a("v-row",{staticClass:"text-center"},[a("v-col",{attrs:{cols:"4"}},[a("div",[a("span",{staticClass:"text-h4"},[e._v(e._s(e.report.goodServices))]),a("span",{staticClass:"text-caption"},[e._v(" /"+e._s(e.report.services))])]),a("div",[e._v("OK")])]),a("v-col",{attrs:{cols:"4"}},[a("div",{staticClass:"text-h4"},[e._v(e._s(e.report.failServices))]),a("div",[e._v("Fail")])]),a("v-col",{attrs:{cols:"4"}},[a("div",{staticClass:"text-h4"},[e._v(e._s(e.report.skipServices))]),a("div",[e._v("Skip")])])],1)],1),a("v-card-actions",[a("div",[a("span",{class:[e.cpuTextColor]},[e._v(e._s(e.cpuDesc)+" cpu")]),a("v-icon",{attrs:{small:""}},[e._v("mdi-circle-small")]),a("span",{class:[e.ramTextColor]},[e._v(e._s(e.ramDesc)+" ram")])],1),a("v-spacer"),a("v-tooltip",{attrs:{color:e.hostLedDesc[0],top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-btn",e._g(e._b({attrs:{icon:""}},"v-btn",s,!1),n),[a("v-icon",[e._v("mdi-table")])],1)]}}]),model:{value:e.tooltipModel,callback:function(t){e.tooltipModel=t},expression:"tooltipModel"}},[a("v-simple-table",{scopedSlots:e._u([{key:"default",fn:function(){return[a("thead",[a("tr",[a("th",{staticClass:"text-left"},[e._v("Service")]),a("th",{staticClass:"text-left"},[e._v("Type")]),a("th",{staticClass:"text-left"},[e._v("Monitor")]),a("th",{staticClass:"text-left"},[e._v("Status")])])]),a("tbody",e._l(e.hostServices,(function(t){return a("tr",{key:e.report.id+"-"+t.name},[a("td",[e._v(e._s(t.name))]),a("td",[e._v(e._s(t.type))]),a("td",[e._v(e._s(e.getServiceMonitorDesc(t.monitor)))]),a("td",[a("v-icon",{attrs:{small:"",color:e.getServiceStatusColor(t.status)}},[e._v(" mdi-circle-medium ")])],1)])})),0)]},proxy:!0}])})],1)],1)],1)},i=[],c=(a("99af"),a("b680"),a("bc3a")),d=a.n(c),u={props:["report"],data:function(){return{tooltipModel:!1,hostServices:[]}},watch:{tooltipModel:function(e){e&&this.__pre_fetch_services__()},report:{handler:function(e){e.alertMessage&&(this.hostServices=[])},deep:!0}},computed:{uptimeDesc:function(){var e=this.report.uptime;switch(!0){case e<60:return"".concat(e," secs");case e<3600:return"".concat((e/60).toFixed(1)," mins");case e<86400:return"".concat((e/3600).toFixed(1)," hrs");default:return"".concat((e/86400).toFixed(1)," days")}},pollTimeDesc:function(){var e=this.report.poll;switch(!0){case e<60:return"".concat(e," secs");case e<3600:return"".concat((e/60).toFixed(1)," mins");case e<86400:return"".concat((e/3600).toFixed(1)," hrs");default:return"".concat((e/86400).toFixed(1)," days")}},cpuDesc:function(){return this.report.cpu.toFixed(1)+"%"},ramDesc:function(){return this.report.ram.toFixed(1)+"%"},cpuTextColor:function(){var e="";switch(!0){case this.report.cpu<80:break;case this.report.cpu<95:e="amber--text";break;case this.report.cpu>=95:e="red--text";break}return e},ramTextColor:function(){var e="";switch(!0){case this.report.ram<80:break;case this.report.ram<95:e="amber--text";break;case this.report.ram>=95:e="red--text";break}return e},hostLedDesc:function(){var e="grey",t="mdi-loading",a="loading";return this.report.alertMessage?(e="red",t="mdi-message-alert"):this.report.services===this.report.failServices?(e="red",t="mdi-alert"):this.report.skipServices>=1||this.report.failServices>=1?(e="amber",t="mdi-alert"):this.report.services===this.report.goodServices&&(e="green",t="mdi-check-bold",a="good"),this.$emit("hostStateChanged",{id:this.report.id,status:a}),[e,t]}},created:function(){this.__pre_fetch_services__()},methods:{__pre_fetch_services__:function(){var e=this;if(!this.report.alertMessage){var t=this.report.id;d.a.get("".concat(this.$GCONFIG.api_base_url,"/api/hosts/").concat(t,"/report")).then((function(t){console.log("HostCard::__pre_fetch_services__() - get report response:",t),t.data.length>0&&(e.hostServices=[],t.data.forEach((function(t){e.hostServices.push(t)})))})).catch((function(e){console.log("HostCard::__pre_fetch_services__() - get report error:",e)}))}},getServiceStatusColor:function(e){switch(e){case 0:return"success";default:return"error"}},getServiceMonitorDesc:function(e){switch(e){case 1:return"Yes";case 0:return"No";case 2:return"Initializing...";default:return"UNKNOWN"}}}},h=u,p=a("2877"),v=a("6544"),m=a.n(v),f=a("8336"),b=a("b0af"),_=a("99d9"),g=a("62ad"),C=a("132d"),S=a("da13"),x=a("8270"),w=a("5d23"),k=a("0fd9"),y=a("1f4f"),A=a("2fa4"),T=a("3a2f"),E=Object(p["a"])(h,l,i,!1,null,null,null),O=E.exports;m()(E,{VBtn:f["a"],VCard:b["a"],VCardActions:_["a"],VCardText:_["b"],VCol:g["a"],VIcon:C["a"],VListItem:S["a"],VListItemAvatar:x["a"],VListItemContent:w["a"],VListItemSubtitle:w["b"],VListItemTitle:w["c"],VRow:k["a"],VSimpleTable:y["a"],VSpacer:A["a"],VTooltip:T["a"]});var R=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-dialog",{attrs:{value:!0,fullscreen:"","hide-overlay":"",transition:"dialog-bottom-transition"},on:{input:function(t){return e.$emit("closeDialog")}}},[a("v-card",[a("v-toolbar",{attrs:{outlined:""}},[a("v-btn",{attrs:{icon:""},on:{click:function(t){return e.$emit("closeDialog")}}},[a("v-icon",[e._v("mdi-close")])],1),a("v-toolbar-title",[e._v("Settings")]),a("v-spacer"),a("v-toolbar-items",[a("v-btn",{attrs:{text:""},on:{click:e.createSomethingNew}},[e._v(" Add new "),a("v-icon",{attrs:{right:""}},[e._v("mdi-plus-circle-outline")])],1)],1)],1),a("v-tabs",{attrs:{right:""},model:{value:e.currentTab,callback:function(t){e.currentTab=t},expression:"currentTab"}},[a("v-tab",{attrs:{href:"#tabAlertRule"}},[e._v("Alert Rules")]),a("v-tab",{attrs:{href:"#tabChannel"}},[e._v("Alert Channels")])],1),a("v-card-text",[a("v-tabs-items",{model:{value:e.currentTab,callback:function(t){e.currentTab=t},expression:"currentTab"}},[a("v-tab-item",{attrs:{value:"tabAlertRule"}},[a("TabViewAlertRule")],1),a("v-tab-item",{attrs:{value:"tabChannel"}},[a("TabViewChannel")],1),a("v-tab-item",{attrs:{value:"tabMailGroup"}},[e._v(" tabMailGroup ")])],1)],1)],1),e.showEditForm?a(e.currentEditForm,{tag:"component",on:{closeDialog:function(t){e.showEditForm=!1}}}):e._e()],1)},j=[],V=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[e._l(Math.ceil(e.alert_channels.length/3),(function(t){return a("v-row",{key:"row-"+t},[e._l(3,(function(n){return[3*(t-1)+(n-1)<e.alert_channels.length?a("v-col",{key:"col-"+t+"-"+n},[a("v-card",{attrs:{"min-height":"195","min-width":"195"}},[a("v-card-title",[a("v-icon",{attrs:{small:"",left:""}},[e._v(e._s(e.getChannelTypeIcon(e.alert_channels[3*(t-1)+(n-1)].type)))]),a("span",{staticClass:"text-subtitle-2 _d-inline-block _text-truncate",attrs:{_style:"cardTitleNameStyle"}},[e._v(e._s(e.alert_channels[3*(t-1)+(n-1)].name))]),a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:function(a){e.editChannel(e.alert_channels[3*(t-1)+(n-1)])}}},[a("v-icon",{attrs:{small:""}},[e._v("mdi-pencil")])],1),a("v-btn",{attrs:{icon:""},on:{click:function(a){e.removeChannel(e.alert_channels[3*(t-1)+(n-1)].id)}}},[a("v-icon",{attrs:{small:""}},[e._v("mdi-delete")])],1)],1),1===e.alert_channels[3*(t-1)+(n-1)].type?a("v-card-text",[a("div",[a("span",{staticClass:"text-caption text--disabled"},[e._v("Sender")]),e._v(" "),a("span",{staticClass:"text-body-2"},[e._v(" "+e._s(e.alert_channels[3*(t-1)+(n-1)].customText)+" ")])]),a("div",[a("span",{staticClass:"text-caption text--disabled"},[e._v("Webhook URL")]),e._v(" "),a("span",{staticClass:"text-body-2"},[e._v(e._s(e.alert_channels[3*(t-1)+(n-1)].webhook_url))])])]):a("v-card-text",[a("div",[a("span",{staticClass:"text-caption text--disabled"},[e._v("Server")]),e._v(" "),a("span",{staticClass:"text-body-2"},[e._v(" "+e._s(e.alert_channels[3*(t-1)+(n-1)].host)+":"+e._s(e.alert_channels[3*(t-1)+(n-1)].port)+" ")])]),a("div",[a("span",{staticClass:"text-caption text--disabled"},[e._v("Sender")]),e._v(" "),a("span",{staticClass:"text-body-2"},[e._v(" "+e._s(e.alert_channels[3*(t-1)+(n-1)].customText)+" <"+e._s(e.alert_channels[3*(t-1)+(n-1)].senderAddress)+"> ")])]),e.smtpAuthEnable(e.alert_channels[3*(t-1)+(n-1)])?[a("div",[a("span",{staticClass:"text-caption text--disabled"},[e._v("Username")]),e._v(" "),a("span",{staticClass:"text-body-2"},[e._v(" "+e._s(e.alert_channels[3*(t-1)+(n-1)].user?e.alert_channels[3*(t-1)+(n-1)].user:"n/a")+" ")])]),a("div",[a("span",{staticClass:"text-caption text--disabled"},[e._v("Password")]),e._v(" "),a("span",{staticClass:"text-body-2"},[e._v(" "+e._s(e.alert_channels[3*(t-1)+(n-1)].passwd?e.alert_channels[3*(t-1)+(n-1)].passwd:"n/a")+" ")])])]:a("div",[a("span",{staticClass:"text-caption text--disabled"},[e._v("Auth")]),e._v(" "),a("span",{staticClass:"text-body-2"},[e._v("Not required")])])],2)],1)],1):e._e()]}))],2)})),e.showEditForm?a("TabEditorChannel",{attrs:{mode:"EDIT",channelPropObject:e.editedObject},on:{closeDialog:function(t){e.showEditForm=!1}}}):e._e(),e.showDeleteConfirm?a("ConfirmDialog",{on:{closeDialog:function(t){e.showDeleteConfirm=!1},agreeConfirm:e.processAgreeConfirm}}):e._e()],2)},D=[],N=(a("b0c0"),a("2f62")),$=a("5a4f"),L=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-row",{attrs:{justify:"center"}},[a("v-dialog",{attrs:{value:!0,"max-width":"290"},on:{input:function(t){return e.$emit("closeDialog")}}},[a("v-card",[a("v-card-title",{staticClass:"text-subtitle-1"},[e._v("Delete this item?")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{text:""},on:{click:function(t){return e.$emit("closeDialog")}}},[e._v("Close")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){return e.$emit("agreeConfirm")}}},[e._v("Agree")])],1)],1)],1)],1)},M=[],P={},I=P,H=a("169a"),F=Object(p["a"])(I,L,M,!1,null,null,null),G=F.exports;m()(F,{VBtn:f["a"],VCard:b["a"],VCardActions:_["a"],VCardTitle:_["c"],VDialog:H["a"],VRow:k["a"],VSpacer:A["a"]});var B={components:{TabEditorChannel:$["default"],ConfirmDialog:G},data:function(){return{showEditForm:!1,editedObject:{},showDeleteConfirm:!1}},computed:Object(r["a"])(Object(r["a"])({},Object(N["b"])(["alert_channels"])),{},{cardTitleNameStyle:function(){var e="max-width: 120px";switch(this.$vuetify.breakpoint.name){case"lg":e="max-width: 16vw";break;case"xl":e="max-width: 17vw";break}return e}}),created:function(){console.log("TabViewChannel::created()...")},methods:{getChannelTypeIcon:function(e){switch(e){case 1:return"mdi-slack";case 2:return"mdi-email"}},removeChannel:function(e){this.showDeleteConfirm=!0,this.deletionPayload={id:e}},processAgreeConfirm:function(){this.deletionPayload.id&&this.__remove_channel_helper__(this.deletionPayload.id),this.showDeleteConfirm=!1},__remove_channel_helper__:function(e){var t=this;console.log("TabViewChannel::removeChannel() with id:",e),d.a.delete("".concat(this.$GCONFIG.api_base_url,"/api/channels/").concat(e)).then((function(a){console.log("TabViewChannel::removeChannel() - get report response:",a),a.data&&("success"===a.data.status?t.$store.commit("REMOVE_ALERT_CHANNEL",e):console.warn("TabViewChannel::removeChannel() - something is wrongs at backend"))})).catch((function(e){console.log("TabViewChannel::removeChannel() - get report error:",e)}))},editChannel:function(e){this.showEditForm=!0,this.editedObject=e},smtpAuthEnable:function(e){return e.user&&e.passwd}}},W=B,U=a("a523"),J=Object(p["a"])(W,V,D,!1,null,null,null),K=J.exports;m()(J,{VBtn:f["a"],VCard:b["a"],VCardText:_["b"],VCardTitle:_["c"],VCol:g["a"],VContainer:U["a"],VIcon:C["a"],VRow:k["a"],VSpacer:A["a"]});var q=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-simple-table",{attrs:{"fixed-header":"",height:"75vh"},scopedSlots:e._u([{key:"default",fn:function(){return[a("thead",[a("tr",[a("th",{staticClass:"text-left"},[e._v("Rule Name")]),a("th",{staticClass:"text-left"},[e._v("Filters")]),a("th",{staticClass:"text-left"},[e._v("Alert Configuration")]),a("th",{staticClass:"text-left"},[e._v("Actions")]),a("th",{staticClass:"text-left"},[e._v("Active")])])]),a("tbody",e._l(e.alertRules,(function(t,n){return a("tr",{key:"item.name"+n},[a("td",{staticClass:"text-caption"},[e._v(e._s(t.name))]),a("td",{staticClass:"text-caption",domProps:{innerHTML:e._s(e.getDisplayTextOfFilters(n))}}),a("td",{staticClass:"text-caption",domProps:{innerHTML:e._s(e.getDisplayTextOfAlertConf(n))}}),a("td",[a("v-btn",{attrs:{icon:""},on:{click:function(a){return e.editRow(t.id,n)}}},[a("v-icon",{attrs:{small:""}},[e._v("mdi-pencil")])],1),a("v-btn",{attrs:{icon:""},on:{click:function(a){return e.deleteRow(t.id,n)}}},[a("v-icon",{attrs:{small:""}},[e._v("mdi-delete")])],1)],1),a("td",[a("v-switch",{attrs:{dense:""},model:{value:t.active,callback:function(a){e.$set(t,"active",a)},expression:"item.active"}})],1)])})),0)]},proxy:!0}])}),e.showEditForm?a("TabEditorAlertRule",{attrs:{mode:"EDIT",alertRuleObject:e.editedObject},on:{closeDialog:function(t){e.showEditForm=!1}}}):e._e(),e.showDeleteConfirm?a("ConfirmDialog",{on:{closeDialog:function(t){e.showDeleteConfirm=!1},agreeConfirm:e.processAgreeConfirm}}):e._e()],1)},Y=[],z=(a("d81d"),a("a434"),a("ac1f"),a("1276"),a("bac9")),Q={components:{TabEditorAlertRule:z["default"],ConfirmDialog:G},data:function(){return{alertRules:[],showEditForm:!1,editedObject:{},showDeleteConfirm:!1,deletionPayload:{}}},computed:{ruleActiveArray:function(){return this.alertRules.map((function(e){return e.active}))}},watch:{ruleActiveArray:{handler:function(e,t){if(e.length===t.length){for(var a={index:-1,value:null},n=0;n<e.length;n++){var s=e[n],o=t[n];if(s!==o){a.value=s,a.index=n;break}}console.log("TabViewAlertRule::watch::ruleActiveArray - changed object:",JSON.stringify(a)),this.changeActiveState(a)}else console.log("TabViewAlertRule::watch::ruleActiveArray - skip inserted item or first load")},deep:!0}},created:function(){var e=this;d.a.get("".concat(this.$GCONFIG.api_base_url,"/api/alert-rules")).then((function(t){console.log("TabViewAlertRule::created() - api response:",t),t.data.length>0&&t.data.forEach((function(t){1===t.active?t.active=!0:t.active=!1,e.alertRules.push(t)}))})).catch((function(e){console.log("TabViewAlertRule::created() - api error:",e)}))},mounted:function(){Pe.$on("NEW_ALERT_RULE_INSERTED",this.__rule_insert_handler__),Pe.$on("NEW_ALERT_RULE_UPDATED",this.__rule_update_handler__)},beforeDestroy:function(){Pe.$off("NEW_ALERT_RULE_INSERTED",this.__rule_insert_handler__),Pe.$off("NEW_ALERT_RULE_UPDATED",this.__rule_update_handler__)},methods:{__rule_insert_handler__:function(e){e.active=!0,console.warn("TabViewAlertRule::__rule_insert_handler__() - item:",e),this.alertRules.splice(0,0,e)},__rule_update_handler__:function(e){console.warn("TabViewAlertRule::__rule_update_handler__() - item:",e),this.alertRules.forEach((function(t){t.id===e.id&&(t.name=e.name,t.filters=e.filters,t.alertConf=e.alertConf)}))},getDisplayTextOfFilters:function(e){var t=this.alertRules[e].filters,a="";return JSON.parse(t).forEach((function(e){if(1===e.services.length)a+='<span class="text--disabled">Host</span> '.concat(e.host,'<span class="text--disabled"> - Services</span> ').concat(e.services,"<br/>");else{var t="<ul>";e.services.forEach((function(e){t+="<li>".concat(e,"</li>")})),t+="</ul>",a+='<span class="text--disabled">Host</span> '.concat(e.host,'<span class="text--disabled"> - Services</span> ').concat(t)}})),a},getDisplayTextOfAlertConf:function(e){var t=JSON.parse(this.alertRules[e].alertConf),a="";return"SMTP"===t.type?(a='<span class="text--disabled">SMTP</span> '.concat(t.name,"<br/>"),a+='<span class="text--disabled">Receivers</span><br/>',a+="<ul>",t.smtpReceivers.split("\n").forEach((function(e){a+="<li>".concat(e,"</li>")})),a+="</ul>"):a='<span class="text--disabled">Slack webhook</span> '.concat(t.name),a},editRow:function(e,t){this.showEditForm=!0,this.editedObject=this.alertRules[t]},deleteRow:function(e,t){this.showDeleteConfirm=!0,this.deletionPayload={id:e,index:t}},processAgreeConfirm:function(){this.deletionPayload.id&&this.deletionPayload.index>=0&&this.__delete_row_helper__(this.deletionPayload.id,this.deletionPayload.index),this.showDeleteConfirm=!1},__delete_row_helper__:function(e,t){var a=this;d.a.delete("".concat(this.$GCONFIG.api_base_url,"/api/alert-rules/").concat(e)).then((function(e){console.log("TabViewAlertRule::deleteRow() - get report response:",e),e.data&&("success"===e.data.status?a.alertRules.splice(t,1):console.warn("TabViewAlertRule::deleteRow() - something is wrongs at backend"))})).catch((function(e){console.log("TabViewAlertRule::deleteRow() - get report error:",e)}))},changeActiveState:function(e){var t=e.index,a=e.value;console.log("TabViewAlertRule::changeActiveState() - index:",t,"- item:",a);var n=a?1:-1,s={headers:{"Content-Type":"text/plain"}};d.a.put("".concat(this.$GCONFIG.api_base_url,"/api/alert-rules/").concat(this.alertRules[t].id,"/active"),n,s).then((function(e){console.log("TabViewAlertRule::changeActiveState() - api response:",e),e.data&&"success"===!e.data.status&&console.warn("TabViewAlertRule::changeActiveState() - something is wrongs at backend")})).catch((function(e){console.log("TabViewAlertRule::changeActiveState() - api error:",e)}))}}},X=Q,Z=a("b73d"),ee=Object(p["a"])(X,q,Y,!1,null,null,null),te=ee.exports;m()(ee,{VBtn:f["a"],VIcon:C["a"],VSimpleTable:y["a"],VSwitch:Z["a"]});var ae={components:{TabViewChannel:K,TabViewAlertRule:te},data:function(){return{currentTab:"tabAlertRule",showEditForm:!1,currentEditForm:null}},mounted:function(){var e=this;d.a.get("".concat(this.$GCONFIG.api_base_url,"/api/channels")).then((function(t){console.log("Setting::mounted() - Get Channels response:",t),t.data.length>0?(e.$store.commit("PURGE_ALERT_CHANNEL"),t.data.forEach((function(t){e.$store.commit("ADD_ALERT_CHANNEL",t)}))):0===t.data.length&&e.$store.commit("PURGE_ALERT_CHANNEL")})).catch((function(e){console.log("Setting::mounted() - Get Channels error:",e)}))},methods:{createSomethingNew:function(){"tabChannel"===this.currentTab?(this.currentEditForm=function(){return Promise.resolve().then(a.bind(null,"5a4f"))},this.showEditForm=!0):"tabAlertRule"===this.currentTab&&(this.currentEditForm=function(){return Promise.resolve().then(a.bind(null,"bac9"))},this.showEditForm=!0)}}},ne=ae,se=a("71a3"),oe=a("c671"),re=a("fe57"),le=a("aac8"),ie=a("71d9"),ce=a("2a7f"),de=Object(p["a"])(ne,R,j,!1,null,null,null),ue=de.exports;m()(de,{VBtn:f["a"],VCard:b["a"],VCardText:_["b"],VDialog:H["a"],VIcon:C["a"],VSpacer:A["a"],VTab:se["a"],VTabItem:oe["a"],VTabs:re["a"],VTabsItems:le["a"],VToolbar:ie["a"],VToolbarItems:ce["a"],VToolbarTitle:ce["b"]});var he={name:"App",components:{HostCard:O,Setting:ue},data:function(){return{APP_VERSION:"2020.0-beta3",num:1,apiError:!1,apiErrorMessage:null,skeletonLoading:!0,drawer:!1,drawerRight:!1,alertSheet:!1,alertCount:0,alertEvents:[],items:[{title:"Dashboard",icon:"mdi-view-dashboard"},{title:"Photos",icon:"mdi-image"},{title:"About",icon:"mdi-help-box"}],socketConnection:null,socketConnected:!1,btnSocketReconnectLoading:!1,hostsReport:[],lastHostsReportTime:null,lastReportTimeStyleClass:"",hostsState:{},hostsNextReportTime:{},showSettingDialog:!1}},computed:Object(r["a"])(Object(r["a"])({},Object(N["b"])(["app_dark_mode","alert_messages"])),{},{hideAlertBadge:function(){return 0==this.alertCount&&this.socketConnected},alertBadgeIconProp:function(){return this.socketConnected?"":{icon:"mdi-close"}},socketConnectionStatusDesc:function(){return this.socketConnected?"connected":"not connect"},socketStatusStyleClass:function(){return this.socketConnected?"text-caption green--text":"text-caption red--text"}}),watch:{alertCount:function(e){document.title=0==e?"CentMonit":e<99?"(".concat(e,") CentMonit"):"(99+) CentMonit"}},created:function(){var e=this;console.log("App::created()..."),this.$vuetify.theme.dark=this.app_dark_mode,d.a.get("".concat(this.$GCONFIG.api_base_url,"/api/hosts/report")).then((function(t){console.log("App::created() - get report response:",t),e.hostsReport=t.data,e.lastHostsReportTime=new Date,e.hostsReport.forEach((function(t){e.$store.commit("ADD_HOST",t.hostname),t.alertMessage||e.$set(e.hostsNextReportTime,t.id,(new Date).getTime()+1e3*t.poll)}))})).catch((function(t){console.log("App::created() - get report error:",t),e.apiError=!0,e.apiErrorMessage=t.message})).finally((function(){setTimeout((function(){e.skeletonLoading=!1}),1500)})),this.__init_socket_connection__()},mounted:function(){var e=this;console.log("App:mounted()...");var t="bgJobID",a=localStorage.getItem(t);a&&(clearInterval(parseInt(a,10)),console.log("Cleared background job with id",a)),a=setInterval((function(){var t=e.hostsNextReportTime;Object.keys(t).forEach((function(a){var n=t[a],s=(new Date).getTime();s>n&&e.hostsReport.forEach((function(t){t.id===a&&(console.warn("No report from ",a,"-",t.hostname),t.alertMessage="No report within poll cycle",e.socketConnected||console.warn("Pls check socket connection..."))}))}))}),3e4),localStorage.setItem(t,a),console.log("Saved background job with id",a)},methods:{__highlight_report_time_text__:function(){var e=this;this.lastReportTimeStyleClass="blinking",setTimeout((function(){e.lastReportTimeStyleClass=""}),3500)},__init_socket_connection__:function(){var e=this;this.socketConnection=new WebSocket(this.$GCONFIG.socket_url),this.socketConnection.onopen=function(){console.log("App::socket::onopen..."),e.socketConnected=!0,e.btnSocketReconnectLoading&&(e.btnSocketReconnectLoading=!1)},this.socketConnection.onerror=function(){console.error("App::socket::error..."),e.btnSocketReconnectLoading&&(e.btnSocketReconnectLoading=!1,e.$toast.open({message:"Could not establish socket connection",type:"error"}))},this.socketConnection.onclose=function(){console.error("App::socket::close..."),e.socketConnected=!1},this.socketConnection.onmessage=function(t){var a=JSON.parse(t.data);if("EVENT"===a.channel)e.alertSheet||e.alertCount++,a["time"]=new Date,e.$store.commit("ADD_ALERT_MESSAGE",a),"Monit"===a.service&&e.hostsReport.forEach((function(t){t.hostname===a.host&&("error"===a.type?(t.alertMessage=a.message,delete e.hostsNextReportTime[t.id]):"success"===a.type&&(t.alertMessage=""))}));else if("HOST"===a.channel){e.lastHostsReportTime=new Date,e.__highlight_report_time_text__();for(var n=!1,s=0;s<e.hostsReport.length;s++){var o=e.hostsReport[s];if(o.id===a.id){o.poll=a.poll,o.uptime=a.uptime,o.ram=a.ram,o.cpu=a.cpu,o.services=a.services,o.goodServices=a.goodServices,o.failServices=a.failServices,o.skipServices=a.skipServices,o.alertMessage="",e.$set(e.hostsNextReportTime,a.id,(new Date).getTime()+1e3*o.poll),n=!0;break}}n||(e.hostsReport.push({id:a.id,poll:a.poll,hostname:a.hostname,uptime:a.uptime,ram:a.ram,cpu:a.cpu,services:a.services,goodServices:a.goodServices,failServices:a.failServices,skipServices:a.skipServices}),e.$set(e.hostsNextReportTime,a.id,(new Date).getTime()+1e3*a.poll),e.$store.commit("ADD_HOST",a.hostname))}}},test:function(){var e="".concat(this.num," Lorem ipsum dolor sit amet consectetur, adipisicing elit<br/>\n        Amet nulla obcaecati laudantium assumenda autem ex qui, non quisquam alias officia?<br/>\n        Neque nulla libero corporis eos atque facilis illum aliquid inventore?");this.num%3==0?this.$toast.open({message:e,type:"error"}):this.$toast.open({message:e}),this.num++},changeDarkMode:function(){var e=!this.app_dark_mode;this.$vuetify.theme.dark=e,this.$store.commit("SET_DARK_MODE",e)},openAlertSheet:function(){this.alertCount=0,this.alertSheet=!this.alertSheet},getAlertColor:function(e){switch(e){case"info":return"info";case"success":return"success";case"error":return"error";case"warning":return"warning";default:return""}},alertReset:function(){this.alertCount=0,this.$store.commit("CLEAR_ALERT_MESSAGES")},reconnectSocket:function(){console.log("App::reconnectSocket()..."),this.btnSocketReconnectLoading=!0,this.__init_socket_connection__()},totalGoodHosts:function(){var e=this;return Object.keys(this.hostsState).filter((function(t){return"good"===e.hostsState[t]})).length},onHostStateChanged:function(e){console.log("App::onHostStateChanged() - payload:",e),this.$set(this.hostsState,e.id,e.status)}}},pe=he,ve=(a("1f3e"),a("0798")),me=a("7496"),fe=a("40dc"),be=a("5bc1"),_e=a("4ca6"),ge=a("e4e5"),Ce=a("288c"),Se=a("ce7e"),xe=a("553a"),we=a("f6c4"),ke=a("3129"),ye=Object(p["a"])(pe,s,o,!1,null,"4b520431",null),Ae=ye.exports;m()(ye,{VAlert:ve["a"],VApp:me["a"],VAppBar:fe["a"],VAppBarNavIcon:be["a"],VBadge:_e["a"],VBanner:ge["a"],VBottomSheet:Ce["a"],VBtn:f["a"],VCard:b["a"],VCardText:_["b"],VCardTitle:_["c"],VCol:g["a"],VContainer:U["a"],VDivider:Se["a"],VFooter:xe["a"],VIcon:C["a"],VMain:we["a"],VRow:k["a"],VSkeletonLoader:ke["a"],VSpacer:A["a"],VToolbarTitle:ce["b"],VTooltip:T["a"]});var Te=a("8c4f");n["default"].use(Te["a"]);var Ee=[{path:"/",name:"route-dashboard"},{path:"/setting",name:"route-setting-page",component:function(){return a.e("about").then(a.bind(null,"e80b"))}}],Oe=new Te["a"]({mode:"history",base:"/",routes:Ee}),Re=Oe,je=(a("c975"),a("bfa9"));n["default"].use(N["a"]);var Ve=new je["a"]({key:"app-store",storage:window.localStorage,reducer:function(e){return{app_dark_mode:e.app_dark_mode,alert_messages:e.alert_messages}}}),De=new N["a"].Store({plugins:[Ve.plugin],state:{app_dark_mode:!1,alert_messages:[],hostnames:[],alert_channels:[]},mutations:{SET_DARK_MODE:function(e,t){e.app_dark_mode=t},ADD_ALERT_MESSAGE:function(e,t){var a=99;e.alert_messages.splice(0,0,t),e.alert_messages.length>a&&e.alert_messages.pop()},CLEAR_ALERT_MESSAGES:function(e){e.alert_messages=[]},ADD_HOST:function(e,t){-1===e.hostnames.indexOf(t)&&e.hostnames.splice(0,0,t)},PURGE_ALERT_CHANNEL:function(e){e.alert_channels=[]},ADD_ALERT_CHANNEL:function(e,t){e.alert_channels.splice(0,0,t)},REMOVE_ALERT_CHANNEL:function(e,t){for(var a=0;a<e.alert_channels.length;a++)if(e.alert_channels[a].id===t){e.alert_channels.splice(a,1);break}},UPDATE_ALERT_CHANNEL:function(e,t){for(var a=0;a<e.alert_channels.length;a++)if(e.alert_channels[a].id===t.id){n["default"].set(e.alert_channels,a,t);break}}},getters:{host_array:function(e){return e.hostnames},slack_iwh_alert_channel:function(e){var t=[];return e.alert_channels.forEach((function(e){1===e.type&&t.push({id:e.id,name:e.name})})),t},smtp_alert_channel:function(e){var t=[];return e.alert_channels.forEach((function(e){2===e.type&&t.push({id:e.id,name:e.name})})),t}},actions:{},modules:{}}),Ne=a("f309");n["default"].use(Ne["a"]);var $e=new Ne["a"]({theme:{}}),Le=a("b079"),Me=a.n(Le);a("ce8c");n["default"].config.productionTip=!1;var Pe=new n["default"];n["default"].use(Me.a,{type:"success",position:"bottom",duration:5e3,pauseOnHover:!0}),d.a.get("/config.json").then((function(e){console.log("main() get config response:",e.data),n["default"].prototype.$GCONFIG=e.data,new n["default"]({router:Re,store:De,vuetify:$e,render:function(e){return e(Ae)}}).$mount("#app")}))},"5a4f":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-dialog",{attrs:{value:!0,"max-width":"600px"},on:{input:function(t){return e.$emit("closeDialog")}}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"text-subtitle-2"},[e._v(" "+e._s("NEW"===e.mode?"New Channel":"Edit Channel")+" ")])]),a("v-card-text",[a("v-form",{model:{value:e.formValid,callback:function(t){e.formValid=t},expression:"formValid"}},[a("v-container",[a("v-row",{attrs:{justify:"center"}},[a("v-col",{attrs:{cols:"12"}},[a("v-text-field",{attrs:{label:"Name*",disabled:"EDIT"===e.mode,clearable:""},model:{value:e.channelObj.name,callback:function(t){e.$set(e.channelObj,"name",t)},expression:"channelObj.name"}})],1),a("v-col",{attrs:{cols:"12"}},[e.enableEditChannelType?a("v-btn-toggle",{staticStyle:{width:"100%"},attrs:{rounded:"",borderless:"",dense:"",mandatory:""},model:{value:e.channelObj.type,callback:function(t){e.$set(e.channelObj,"type",t)},expression:"channelObj.type"}},[a("v-btn",{staticStyle:{width:"50%"},attrs:{small:"",value:"SLACK_WEBHOOKS"}},[a("span",{staticClass:"hidden-xs-only"},[e._v("Slack incoming webhooks")]),a("span",{staticClass:"hidden-sm-and-up"},[e._v("Slack")])]),a("v-btn",{staticStyle:{width:"50%"},attrs:{small:"",value:"SMTP"}},[a("span",{staticClass:"hidden-xs-only"},[e._v("SMTP mail server")]),a("span",{staticClass:"hidden-sm-and-up"},[e._v("SMTP")])])],1):e._e()],1),"SMTP"===e.channelObj.type?[a("v-col",{attrs:{cols:"12",sm:"6"}},[a("v-text-field",{attrs:{label:"Server hostname or IP*",clearable:""},model:{value:e.channelObj.host,callback:function(t){e.$set(e.channelObj,"host",t)},expression:"channelObj.host"}})],1),a("v-col",{attrs:{cols:"12",sm:"6"}},[a("v-text-field",{attrs:{label:"Server port*",type:"number",clearable:""},model:{value:e.channelObj.port,callback:function(t){e.$set(e.channelObj,"port",t)},expression:"channelObj.port"}})],1),a("v-col",{attrs:{cols:"12"}},[a("v-text-field",{attrs:{label:"Sender address*",clearable:""},model:{value:e.channelObj.senderAddress,callback:function(t){e.$set(e.channelObj,"senderAddress",t)},expression:"channelObj.senderAddress"}})],1),a("v-col",{attrs:{cols:"8",sm:"8"}},[a("v-text-field",{attrs:{label:"Sender name*",clearable:"","persistent-hint":!0,hint:"Use this field to differentiate alert messages from different Systems/Datacenters"},model:{value:e.channelObj.customText,callback:function(t){e.$set(e.channelObj,"customText",t)},expression:"channelObj.customText"}})],1),a("v-col",{attrs:{cols:"4",sm:"4"}},[a("v-switch",{attrs:{label:"Authentication",dense:""},model:{value:e.channelObj.authEnable,callback:function(t){e.$set(e.channelObj,"authEnable",t)},expression:"channelObj.authEnable"}})],1),e.channelObj.authEnable?a("v-col",{attrs:{cols:"12",sm:"6"}},[a("v-text-field",{attrs:{label:"Username*",clearable:""},model:{value:e.channelObj.user,callback:function(t){e.$set(e.channelObj,"user",t)},expression:"channelObj.user"}})],1):e._e(),e.channelObj.authEnable?a("v-col",{attrs:{cols:"12",sm:"6"}},[a("v-text-field",{attrs:{label:"Password*",clearable:""},model:{value:e.channelObj.passwd,callback:function(t){e.$set(e.channelObj,"passwd",t)},expression:"channelObj.passwd"}})],1):e._e()]:[a("v-col",{attrs:{cols:"12"}},[a("v-text-field",{attrs:{label:"Sender Name*",clearable:"","persistent-hint":!0,hint:"Use this field to differentiate alert messages from different Systems/Datacenters"},model:{value:e.channelObj.customText,callback:function(t){e.$set(e.channelObj,"customText",t)},expression:"channelObj.customText"}})],1),a("v-col",{attrs:{cols:"12"}},[a("v-text-field",{attrs:{label:"Webhook URL*","append-icon":"mdi-help-circle-outline","persistent-hint":!0,hint:"Click help icon on the right for Slack webhook tutorial",clearable:""},on:{"click:append":e.openSlackWebhookHelp},model:{value:e.channelObj.webhook_url,callback:function(t){e.$set(e.channelObj,"webhook_url",t)},expression:"channelObj.webhook_url"}})],1)]],2)],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{text:""},on:{click:function(t){return e.$emit("closeDialog")}}},[e._v("Close")]),a("v-btn",{attrs:{text:"",color:"primary",disabled:e.disableSaveButton},on:{click:e.saveChannel}},[e._v("Save")])],1)],1)],1)},s=[],o=(a("99af"),a("b0c0"),a("498a"),a("5530")),r=a("bc3a"),l=a.n(r),i={props:{mode:{type:String,default:"NEW"},channelPropObject:Object},data:function(){return{formValid:!1,channelObj:{name:"Default channel",type:"SLACK_WEBHOOKS",webhook_url:null,host:"smtp.gmail.com",port:587,ssl:!0,user:null,passwd:null,authEnable:!1,customText:"CentMonit",senderAddress:"example@email.com"}}},computed:{enableEditChannelType:function(){return"NEW"===this.mode},disableSaveButton:function(){return"SLACK_WEBHOOKS"===this.channelObj.type?!this.channelObj.name||!this.channelObj.webhook_url||!this.channelObj.customText:!this.channelObj.name||!this.channelObj.customText||!this.channelObj.senderAddress||!this.channelObj.host||!this.channelObj.port||this.channelObj.authEnable&&(!this.channelObj.user||!this.channelObj.passwd)}},created:function(){"EDIT"===this.mode&&(this.channelObj.name=this.channelPropObject.name,this.channelObj.customText=this.channelPropObject.customText,1===this.channelPropObject.type?(this.channelObj.type="SLACK_WEBHOOKS",this.channelObj.webhook_url=this.channelPropObject.webhook_url):(this.channelObj.type="SMTP",this.channelObj.host=this.channelPropObject.host,this.channelObj.port=this.channelPropObject.port,this.channelObj.user=this.channelPropObject.user,this.channelObj.passwd=this.channelPropObject.passwd,this.channelObj.authEnable=Boolean(this.channelPropObject.user)&&Boolean(this.channelPropObject.passwd),this.channelObj.senderAddress=this.channelPropObject.senderAddress))},methods:{saveChannel:function(){var e=this;console.log("TabEditorChannel::saveChannel() obj:",JSON.stringify(this.channelObj));var t=Object(o["a"])({},this.channelObj);"string"===typeof t.port&&(t.port=parseInt(t.port,10)),t.type="SLACK_WEBHOOKS"===t.type?1:2,t.authEnable?(t.user=t.user.trim(),t.passwd=t.passwd.trim()):(t.user=null,t.passwd=null),t.host&&(t.host=t.host.trim()),t.webhook_url&&(t.webhook_url=t.webhook_url.trim()),"NEW"===this.mode?l.a.post("".concat(this.$GCONFIG.api_base_url,"/api/channels"),t).then((function(a){console.log("TabEditorChannel::saveChannel() - create response:",a),a.data&&("success"===a.data.status?(t.id=a.data.id,e.$store.commit("ADD_ALERT_CHANNEL",t),e.$emit("closeDialog")):console.warn("TabEditorChannel::saveChannel() - something is wrongs at backend when create"))})).catch((function(e){console.log("TabEditorChannel::saveChannel() - create error:",e)})):l.a.put("".concat(this.$GCONFIG.api_base_url,"/api/channels/").concat(this.channelPropObject.id),t).then((function(a){if(console.log("TabEditorChannel::saveChannel() - update response:",a),a.data)if("success"===a.data.status){var n=Object(o["a"])({id:e.channelPropObject.id},t);e.$store.commit("UPDATE_ALERT_CHANNEL",n),e.$emit("closeDialog")}else console.warn("TabEditorChannel::saveChannel() - something is wrongs at backend when update")})).catch((function(e){console.log("TabEditorChannel::saveChannel() - update error:",e)}))},openSlackWebhookHelp:function(){window.open("https://slack.com/intl/en-vn/help/articles/115005265063-Incoming-Webhooks-for-Slack","_blank")}}},c=i,d=a("2877"),u=a("6544"),h=a.n(u),p=a("8336"),v=a("a609"),m=a("b0af"),f=a("99d9"),b=a("62ad"),_=a("a523"),g=a("169a"),C=a("4bd4"),S=a("0fd9"),x=a("2fa4"),w=a("b73d"),k=a("8654"),y=Object(d["a"])(c,n,s,!1,null,null,null);t["default"]=y.exports;h()(y,{VBtn:p["a"],VBtnToggle:v["a"],VCard:m["a"],VCardActions:f["a"],VCardText:f["b"],VCardTitle:f["c"],VCol:b["a"],VContainer:_["a"],VDialog:g["a"],VForm:C["a"],VRow:S["a"],VSpacer:x["a"],VSwitch:w["a"],VTextField:k["a"]})},bac9:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-dialog",{attrs:{value:!0,"min-width":"90vw"},on:{input:function(t){return e.$emit("closeDialog")}}},[a("v-stepper",{model:{value:e.currentStep,callback:function(t){e.currentStep=t},expression:"currentStep"}},[a("v-stepper-header",[a("v-stepper-step",{attrs:{complete:e.currentStep>1,step:"1"}},[e._v("Rule name")]),a("v-divider"),a("v-stepper-step",{attrs:{complete:e.currentStep>2,step:"2"}},[e._v("Filters")]),a("v-divider"),a("v-stepper-step",{attrs:{step:"3"}},[e._v("Alert configuration")])],1),a("v-stepper-items",[a("v-stepper-content",{attrs:{step:"1"}},[a("v-form",[a("v-container",[a("v-row",{attrs:{justify:"center"}},[a("v-col",{attrs:{md:"4",sm:"12"}},[a("v-text-field",{attrs:{label:"Rule name*",clearable:""},model:{value:e.ruleName,callback:function(t){e.ruleName=t},expression:"ruleName"}})],1)],1)],1)],1),a("v-btn",{attrs:{text:"",color:"primary",disabled:e.disableStep2},on:{click:function(t){e.currentStep=2}}},[e._v("Next")]),a("v-btn",{attrs:{text:""},on:{click:function(t){return e.$emit("closeDialog")}}},[e._v("Close")])],1),a("v-stepper-content",{attrs:{step:"2"}},[a("v-form",[a("v-container",[a("v-row",{attrs:{justify:"center"}},[a("v-col",{staticClass:"text-center"},[e.filters.length>1?a("small",[e._v(" These "+e._s(e.filters.length)+" filters will be combinated by "),a("strong",[e._v("OR")]),e._v(" operator. ")]):a("small",[e._v(" If the server's hostname or the service's name was changed, you need to reconfig this filter. ")])])],1),e._l(e.filters,(function(t,n){return a("v-row",{key:n,attrs:{justify:"center",align:"center"}},[a("v-col",{attrs:{md:"4",sm:"5",cols:"12"}},[a("v-combobox",{attrs:{label:"Host",dense:"",items:e.selectionHostItems,clearable:""},model:{value:t.modelHost,callback:function(a){e.$set(t,"modelHost",a)},expression:"filter.modelHost"}})],1),a("v-col",{attrs:{md:"4",sm:"5",cols:"10"}},[a("v-combobox",{attrs:{label:"Service(s)",dense:"",items:t.services,"small-chips":"",multiple:"","hide-selected":"","search-input":t.serviceSearchText,disabled:t.disableService,hint:"Type or select from list","persistent-hint":"",clearable:""},on:{"update:searchInput":function(a){return e.$set(t,"serviceSearchText",a)},"update:search-input":function(a){return e.$set(t,"serviceSearchText",a)}},scopedSlots:e._u([{key:"no-data",fn:function(){return[a("v-list-item",[a("v-list-item-content",[a("v-list-item-title",[e._v(' No results matching "'),a("strong",[e._v(e._s(t.serviceSearchText))]),e._v('", press '),a("code",[e._v("enter")]),e._v(" to create a new one. ")])],1)],1)]},proxy:!0}],null,!0),model:{value:t.modelService,callback:function(a){e.$set(t,"modelService",a)},expression:"filter.modelService"}})],1),a("v-col",{attrs:{md:"2"}},[n===e.filters.length-1?a("v-btn",{attrs:{icon:"",small:"",disabled:"All"===e.firstHostModel},on:{click:e.addEventFilter}},[a("v-icon",{attrs:{small:"",color:"primary"}},[e._v("mdi-plus-circle")])],1):a("v-btn",{attrs:{icon:"",small:""},on:{click:function(t){return e.removeEventFilter(n)}}},[a("v-icon",{attrs:{small:"",color:"primary"}},[e._v("mdi-minus-circle")])],1)],1)],1)}))],2)],1),a("v-btn",{attrs:{text:"",color:"primary",disabled:e.disableStep3},on:{click:function(t){e.currentStep=3}}},[e._v("Next")]),a("v-btn",{attrs:{text:""},on:{click:function(t){return e.$emit("closeDialog")}}},[e._v("Close")])],1),a("v-stepper-content",{attrs:{step:"3"}},[a("v-form",[a("v-container",[a("v-row",{attrs:{justify:"center"}},[a("v-col",{attrs:{md:"4",sm:"6",cols:"12"}},[a("v-select",{attrs:{label:"Alert channel*",items:e.alertChannels,clearable:""},model:{value:e.modelAlertChannel.type,callback:function(t){e.$set(e.modelAlertChannel,"type",t)},expression:"modelAlertChannel.type"}})],1),a("v-col",{attrs:{md:"4",sm:"6",cols:"12"}},["Slack Webhook"===e.modelAlertChannel.type?a("v-select",{attrs:{label:"Choose a channel",items:e.$store.getters.slack_iwh_alert_channel,"item-text":"name","item-value":"id"},model:{value:e.modelAlertChannel.value,callback:function(t){e.$set(e.modelAlertChannel,"value",t)},expression:"modelAlertChannel.value"}}):"SMTP"===e.modelAlertChannel.type?a("v-select",{attrs:{label:"Choose a channel",items:e.$store.getters.smtp_alert_channel,"item-text":"name","item-value":"id"},model:{value:e.modelAlertChannel.value,callback:function(t){e.$set(e.modelAlertChannel,"value",t)},expression:"modelAlertChannel.value"}}):e._e()],1),"SMTP"===e.modelAlertChannel.type?a("v-col",{attrs:{md:"8",cols:"12"}},[a("v-textarea",{attrs:{label:"Receiver(s)",placeholder:"user@email.com",hint:"Email addresses are separated by enter (newline) character","persistent-hint":"",clearable:""},model:{value:e.modelAlertChannel.smtpReceivers,callback:function(t){e.$set(e.modelAlertChannel,"smtpReceivers",t)},expression:"modelAlertChannel.smtpReceivers"}})],1):e._e()],1)],1)],1),a("v-btn",{attrs:{text:"",color:"primary",disabled:e.disableSave},on:{click:e.saveRule}},[e._v("Save")]),a("v-btn",{attrs:{text:""},on:{click:function(t){return e.$emit("closeDialog")}}},[e._v("Close")])],1)],1)],1)],1)},s=[],o=(a("99af"),a("4160"),a("c975"),a("d81d"),a("a434"),a("b0c0"),a("159b"),a("5530")),r=(a("96cf"),a("1da1")),l=a("bc3a"),i=a.n(l),c=a("56d7"),d={props:{mode:{type:String,default:"NEW"},alertRuleObject:Object},data:function(){return{currentStep:1,ruleName:"Default rule",filters:[{modelHost:null,modelService:[],disableService:!1,serviceSearchText:null,services:null}],modelAlertChannel:{type:null,name:null,value:null,smtpReceivers:null},alertChannels:["Slack Webhook","SMTP"]}},computed:{filtersModelHostArray:function(){return this.filters.map((function(e){return e.modelHost}))},filtersModelServiceArray:function(){return this.filters.map((function(e){return e.modelService}))},selectionHostItems:function(){return["All"].concat(this.$store.getters.host_array)},firstHostModel:function(){return this.filters[0].modelHost},disableStep2:function(){return!this.ruleName},disableStep3:function(){return!this.filters[0].modelHost||!this.filters[0].modelService.length>0},disableSave:function(){return this.modelAlertChannel.type===this.alertChannels[1]?!this.modelAlertChannel.value||!this.modelAlertChannel.smtpReceivers:this.modelAlertChannel.type!==this.alertChannels[0]||!this.modelAlertChannel.value}},watch:{filtersModelHostArray:{handler:function(e,t){var a=this,n={item:null,index:-1};if(e.length>t.length)n.item=e[e.length-1],n.index=e.length-1;else if(e.length<t.length);else for(var s=0;s<e.length;s++){var o=e[s],r=t[s];if(o!==r){n.item=o,n.index=s;break}}if(console.warn("TabEditorAlertRule::watch::filtersModelHostArray - changed item:",JSON.stringify(n.item),"- at index:",n.index),"All"===n.item){this.filters[n.index].modelService=["All"],this.filters[n.index].disableService=!0;for(var l=0;l<this.filters.length;l++)l!==n.index&&this.filters.splice(l,1)}else n.item&&(this.filters[n.index].disableService=!1,i.a.get("".concat(this.$GCONFIG.api_base_url,"/api/hostnames/").concat(n.item,"/report")).then((function(e){console.log("TabEditorAlertRule::watch::filtersModelHostArray - API response:",e),e.data&&(a.filters[n.index].services=["All"].concat(e.data))})).catch((function(e){console.log("TabEditorAlertRule::watch::filtersModelHostArray - API error:",e)})))},deep:!0},filtersModelServiceArray:{handler:function(e){console.warn("TabEditorAlertRule::watch::filtersModelServiceArray - val:",JSON.stringify(e));for(var t=0;t<e.length;t++){var a=e[t];if(a){var n=a.indexOf("All");a.length>1&&n>-1&&(n===a.length-1?this.filters[t].modelService=["All"]:this.filters[t].modelService.splice(n,1))}}},deep:!0},"modelAlertChannel.type":function(e,t){console.log("modelAlertChannel type: newVal:",e," - oldVal:",t),e&&t&&(this.modelAlertChannel.name=null,this.modelAlertChannel.value=null,this.modelAlertChannel.smtpReceivers=null)}},created:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a,n,s,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("EDIT"!==e.mode){t.next=24;break}e.ruleName=e.alertRuleObject.name,e.modelAlertChannel=JSON.parse(e.alertRuleObject.alertConf),console.warn(e.alertRuleObject.filters),a=JSON.parse(e.alertRuleObject.filters),n=0;case 6:if(!(n<a.length)){t.next=24;break}return s=a[n],n===e.filters.length&&e.addEventFilter(),e.filters[n].modelHost=s.host,e.filters[n].modelService=s.services,t.prev=11,t.next=14,i.a.get("".concat(e.$GCONFIG.api_base_url,"/api/hostnames/").concat(s.host,"/report"));case 14:o=t.sent,o&&(console.log("TabEditorAlertRule::created() - edit mode - API response:",JSON.stringify(o.data)),o.data&&(e.filters[n].services=["All"].concat(o.data))),t.next=21;break;case 18:t.prev=18,t.t0=t["catch"](11),console.log("TabEditorAlertRule::created() - edit mode - API error:",t.t0);case 21:n++,t.next=6;break;case 24:case"end":return t.stop()}}),t,null,[[11,18]])})))()},methods:{addEventFilter:function(){this.filters.push({modelHost:null,modelService:[],disableService:!1,serviceSearchText:null,services:null})},removeEventFilter:function(e){console.log("TabEditorAlertRule::removeEventFilter() - with index:",e),this.filters.splice(e,1)},saveRule:function(){var e=this,t=[];this.filters.forEach((function(e){t.push({host:e.modelHost,services:e.modelService})}));var a=this.modelAlertChannel.value;"SMTP"===this.modelAlertChannel.type?this.$store.getters.smtp_alert_channel.forEach((function(t){t.id===a&&(e.modelAlertChannel.name=t.name)})):(this.modelAlertChannel.smtpReceivers=null,this.$store.getters.slack_iwh_alert_channel.forEach((function(t){t.id===a&&(e.modelAlertChannel.name=t.name)})));var n={name:this.ruleName,filters:JSON.stringify(t),alertConf:JSON.stringify(this.modelAlertChannel)};console.log("TabEditorAlertRule::saveRule() - requestObj:",n),"NEW"===this.mode?i.a.post("".concat(this.$GCONFIG.api_base_url,"/api/alert-rules"),n).then((function(t){console.log("TabEditorAlertRule::saveRule() - create response:",t),t.data&&("success"===t.data.status?(c["EventBus"].$emit("NEW_ALERT_RULE_INSERTED",Object(o["a"])({id:t.data.id},n)),e.$emit("closeDialog")):console.warn("TabEditorAlertRule::saveRule() - something is wrongs at backend when create"))})).catch((function(e){console.log("TabEditorAlertRule::saveRule() - create error:",e)})):i.a.put("".concat(this.$GCONFIG.api_base_url,"/api/alert-rules/").concat(this.alertRuleObject.id),n).then((function(t){console.log("TabEditorAlertRule::saveRule() - update response:",t),t.data&&("success"===t.data.status?(c["EventBus"].$emit("NEW_ALERT_RULE_UPDATED",Object(o["a"])({id:e.alertRuleObject.id},n)),e.$emit("closeDialog")):console.warn("TabEditorAlertRule::saveRule() - something is wrongs at backend when update"))})).catch((function(e){console.log("TabEditorAlertRule::saveRule() - update error:",e)}))}}},u=d,h=a("2877"),p=a("6544"),v=a.n(p),m=a("8336"),f=a("62ad"),b=a("2b5d"),_=a("a523"),g=a("169a"),C=a("ce7e"),S=a("4bd4"),x=a("132d"),w=a("da13"),k=a("5d23"),y=a("0fd9"),A=a("b974"),T=a("7e85"),E=a("e516"),O=a("9c54"),R=a("56a4"),j=a("8654"),V=a("a844"),D=Object(h["a"])(u,n,s,!1,null,null,null);t["default"]=D.exports;v()(D,{VBtn:m["a"],VCol:f["a"],VCombobox:b["a"],VContainer:_["a"],VDialog:g["a"],VDivider:C["a"],VForm:S["a"],VIcon:x["a"],VListItem:w["a"],VListItemContent:k["a"],VListItemTitle:k["c"],VRow:y["a"],VSelect:A["a"],VStepper:T["a"],VStepperContent:E["a"],VStepperHeader:O["a"],VStepperItems:O["b"],VStepperStep:R["a"],VTextField:j["a"],VTextarea:V["a"]})},fb50:function(e,t,a){}});
//# sourceMappingURL=app.d5ffee89.js.map