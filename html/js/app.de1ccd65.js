(function(e){function t(t){for(var a,r,i=t[0],l=t[1],c=t[2],d=0,h=[];d<i.length;d++)r=i[d],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&h.push(s[r][0]),s[r]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);u&&u(t);while(h.length)h.shift()();return o.push.apply(o,c||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,r=1;r<n.length;r++){var l=n[r];0!==s[l]&&(a=!1)}a&&(o.splice(t--,1),e=i(i.s=n[0]))}return e}var a={},s={app:0},o=[];function r(e){return i.p+"js/"+({about:"about"}[e]||e)+"."+{about:"dd8d9938"}[e]+".js"}function i(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.e=function(e){var t=[],n=s[e];if(0!==n)if(n)t.push(n[2]);else{var a=new Promise((function(t,a){n=s[e]=[t,a]}));t.push(n[2]=a);var o,l=document.createElement("script");l.charset="utf-8",l.timeout=120,i.nc&&l.setAttribute("nonce",i.nc),l.src=r(e);var c=new Error;o=function(t){l.onerror=l.onload=null,clearTimeout(d);var n=s[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+a+": "+o+")",c.name="ChunkLoadError",c.type=a,c.request=o,n[1](c)}s[e]=void 0}};var d=setTimeout((function(){o({type:"timeout",target:l})}),12e4);l.onerror=l.onload=o,document.head.appendChild(l)}return Promise.all(t)},i.m=e,i.c=a,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/",i.oe=function(e){throw console.error(e),e};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],c=l.push.bind(l);l.push=t,l=l.slice();for(var d=0;d<l.length;d++)t(l[d]);var u=c;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t),n.d(t,"EventBus",(function(){return it}));n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",[n("v-app-bar",{attrs:{app:"","clipped-left":"","clipped-right":""}},[n("v-app-bar-nav-icon",{attrs:{disabled:"",_click:"drawer = !drawer"}}),n("v-toolbar-title",[e._v("Dashboard")]),n("v-spacer"),n("v-badge",e._b({attrs:{content:e.alertCount,dot:e.hideAlertBadge,color:"error",left:"",_overlap:"","offset-x":"23","offset-y":"23"}},"v-badge",e.alertBadgeIconProp,!1),[n("v-btn",{attrs:{icon:""},on:{click:e.openAlertSheet}},[n("v-icon",[e._v("mdi-bell")])],1)],1),n("v-tooltip",{attrs:{bottom:"","open-delay":1e3},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,s=t.attrs;return[n("v-btn",e._g(e._b({attrs:{icon:""},on:{click:e.changeDarkMode}},"v-btn",s,!1),a),[n("v-icon",[e._v("mdi-theme-light-dark")])],1)]}}])},[n("span",[e._v("Switch to day/night mode")])]),n("v-btn",{attrs:{icon:""},on:{click:function(t){e.showSettingDialog=!0}}},[n("v-icon",[e._v("mdi-cog")])],1),n("v-btn",{attrs:{icon:""},on:{click:function(t){e.showLicenseDialog=!0}}},[n("v-icon",[e._v("mdi-shield-key")])],1)],1),n("v-main",[e.socketConnected?e._e():n("v-banner",{attrs:{app:"","single-line":"",_color:"white",icon:"mdi-wifi-strength-alert-outline","icon-color":"red"},scopedSlots:e._u([{key:"actions",fn:function(){return[n("v-btn",{attrs:{text:"",color:"primary",loading:e.btnSocketReconnectLoading,disabled:e.btnSocketReconnectLoading},on:{click:e.reconnectSocket}},[e._v(" Reconnect ")])]},proxy:!0}],null,!1,2500245156)},[e._v(" Lost socket connection to API Server ")]),n("v-container",{attrs:{fluid:""}},[e.skeletonLoading?n("v-row",e._l(9,(function(e){return n("v-col",{key:e,attrs:{cols:"12",lg:"3"}},[n("v-skeleton-loader",{staticClass:"mx-auto",attrs:{_loading:"skeletonLoading",transition:"scale-transition","max-width":"300",type:"card"}})],1)})),1):0==e.hostsReport.length?n("v-row",[n("v-col",[e.apiError?e.socketConnected?n("v-alert",{attrs:{text:"",color:"info",border:"left"}},[n("div",[e._v("Please waiting for the first report being aggregated at CentMonit...")])]):n("v-alert",{attrs:{text:"",color:"error",border:"left"}},[n("h3",{staticClass:"headline"},[e._v(e._s(e.apiErrorMessage))]),n("div",[e._v(" Is CentMonit daemon process running normally on the server side (at address "+e._s(""+this.$GCONFIG.api_base_url)+")?"),n("br"),e._v(" Try restart it then reload your browser (Ctrl + F5). ")])]):n("v-alert",{attrs:{text:"",color:"info",border:"left"}},[n("h3",{staticClass:"headline"},[e._v("No data found")]),n("div",[e._v(" You may need to wait for CentMonit to receive first report data from Monit agents."),n("br"),e._v(" If you've waited so long, then check your Monit log (/var/log/monit.log) to see whether it successfully send report data to CentMonit?"),n("br"),e._v(" Please follow the setup manual from installation folder to verify Monit and CentMonit's configuration. ")])])],1)],1):n("div",[n("v-row",{staticClass:"justify-center"},[n("div",{class:[e.lastReportTimeStyleClass],staticStyle:{color:"#2196F3"}},[n("span",{staticClass:"text-lowercase text-caption"},[e._v("Healthy hosts")]),e._v(" "),n("span",{staticClass:"text-subtitle-2"},[e._v(e._s(e.totalGoodHosts())+"/"+e._s(Object.keys(e.hostsState).length))]),e._v(" - "),n("span",{staticClass:"text-lowercase text-caption"},[e._v("Last report")]),e._v(" "),n("span",{staticClass:"text-subtitle-2"},[e._v(e._s(e.lastHostsReportTime.toLocaleString()))])])]),n("v-row",e._l(e.hostsReport,(function(t,a){return n("v-col",{key:a+"-"+t.alertMessage,attrs:{_key:"index",cols:"12",_sm:"6",md:"6",lg:"4"}},[n("HostCard",{attrs:{report:t},on:{hostStateChanged:e.onHostStateChanged}})],1)})),1)],1),n("v-bottom-sheet",{staticStyle:{"overflow-y":"scroll"},model:{value:e.alertSheet,callback:function(t){e.alertSheet=t},expression:"alertSheet"}},[n("v-card",[n("v-card-title",{attrs:{_class:"justify-center"}},[n("span",{staticClass:"text-subtitle-1"},[e._v("Realtime Channel")]),n("v-icon",[e._v("mdi-circle-small")]),n("span",{class:[e.socketStatusStyleClass]},[e._v(e._s(e.socketConnectionStatusDesc))]),n("v-spacer"),n("v-tooltip",{attrs:{bottom:"","open-delay":1e3},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,s=t.attrs;return[n("v-btn",e._g(e._b({attrs:{icon:""},on:{click:e.alertReset}},"v-btn",s,!1),a),[n("v-icon",[e._v("mdi-notification-clear-all")])],1)]}}])},[n("span",[e._v("Clear all messages (old messages will be removed automatically)")])]),n("v-btn",{attrs:{icon:""},on:{click:function(t){e.alertSheet=!e.alertSheet}}},[n("v-icon",[e._v("mdi-chevron-down")])],1)],1),n("v-divider"),n("v-card-text",{staticClass:"pt-4",staticStyle:{height:"80vh","overflow-y":"scroll"}},[e.socketConnected?e._e():n("div",{staticClass:"text-center"},[n("v-btn",{staticClass:"mb-2",attrs:{loading:e.btnSocketReconnectLoading,disabled:e.btnSocketReconnectLoading,outlined:"",color:"primary"},on:{click:e.reconnectSocket}},[e._v(" Reconnect "),n("v-icon",{attrs:{right:""}},[e._v("mdi-sync")])],1)],1),e._l(e.alert_messages,(function(t,a){return n("v-alert",{key:a,attrs:{border:"left","colored-border":"",color:e.getAlertColor(t.type),elevation:"1"}},[Boolean(t.host)?n("span",{staticClass:"text-subtile-1 font-weight-bold"},[e._v(" "+e._s(t.host)+" "),Boolean(t.service)?[n("v-icon",{attrs:{small:""}},[e._v("mdi-circle-small")]),e._v(" "+e._s(t.service)+" ")]:e._e(),n("br")],2):e._e(),n("span",{staticClass:"text-caption"},[n("v-icon",{attrs:{small:""}},[e._v("mdi-calendar-clock")]),e._v(" "+e._s(t.time.toLocaleString())),n("br")],1),Boolean(t.serviceTypeDesc)?n("span",{staticClass:"text-caption"},[n("v-icon",{attrs:{small:""}},[e._v("mdi-tag-text-outline")]),e._v(" "+e._s(t.serviceTypeDesc)),n("br")],1):e._e(),n("div",{staticClass:"mt-1"},[e._v(" "+e._s(t.message)+" ")])])}))],2)],1)],1),e.showSettingDialog?n("Setting",{on:{closeDialog:function(t){e.showSettingDialog=!1}}}):e._e(),e.showLicenseDialog?n("License",{on:{closeDialog:function(t){e.showLicenseDialog=!1}}}):e._e()],1)],1),n("v-footer",{attrs:{app:"",_class:"grey _dark_en-3 white--text"}},[n("div",{staticClass:"text-caption",attrs:{_class:"ml-3 text-caption text-sm-body-2"}},[e._v(" Made with "),n("v-icon",{staticClass:"red--text",staticStyle:{"vertical-align":"middle"},attrs:{small:""}},[e._v("mdi-heart-outline")]),e._v(" by "),n("a",{attrs:{_class:"white--text",href:"https://vuetifyjs.com",target:"_blank"}},[e._v("Vuetify")])],1),n("v-spacer"),n("div",{staticClass:"font-italic caption",attrs:{_class:"mr-3 hidden-xs-only"}},[e._v(" CentMonit "+e._s(e.APP_VERSION)+" ")])],1)],1)},o=[],r=(n("4de4"),n("4160"),n("b64b"),n("d3b7"),n("159b"),n("5530")),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card",{staticClass:"mx-auto",attrs:{"max-width":"350","min-height":"206",_click:"test"}},[n("v-list-item",{attrs:{"_three-line":""}},[n("v-list-item-avatar",[n("v-icon",{class:"mdi-loading"===e.hostLedDesc[1]?"mdi-spin":"",attrs:{color:e.hostLedDesc[0]}},[e._v(e._s(e.hostLedDesc[1]))])],1),n("v-list-item-content",[n("v-list-item-title",{staticClass:"text-subtile-1 font-weight-bold"},[e._v(" "+e._s(e.report.hostname)+" ")]),n("v-list-item-subtitle",{staticClass:"text-caption"},[n("span",[e._v(e._s(e.uptimeDesc)+" monit up")]),n("v-icon",{attrs:{small:""}},[e._v("mdi-circle-small")]),n("span",[e._v(e._s(e.pollTimeDesc)+" poll-cycle")])],1)],1)],1),n("v-card-text",[e.report.alertMessage?n("v-row",{staticClass:"text-center"},[n("v-col",{attrs:{cols:"12"}},[n("div",[e._v(e._s(e.report.alertMessage))])])],1):n("v-row",{staticClass:"text-center"},[n("v-col",{attrs:{cols:"4"}},[n("div",[n("span",{staticClass:"text-h4"},[e._v(e._s(e.report.goodServices))]),n("span",{staticClass:"text-caption"},[e._v(" /"+e._s(e.report.services))])]),n("div",[e._v("OK")])]),n("v-col",{attrs:{cols:"4"}},[n("div",{staticClass:"text-h4"},[e._v(e._s(e.report.failServices))]),n("div",[e._v("Fail")])]),n("v-col",{attrs:{cols:"4"}},[n("div",{staticClass:"text-h4"},[e._v(e._s(e.report.skipServices))]),n("div",[e._v("Skip")])])],1)],1),n("v-card-actions",[n("div",[n("span",{class:[e.cpuTextColor]},[e._v(e._s(e.cpuDesc)+" cpu")]),n("v-icon",{attrs:{small:""}},[e._v("mdi-circle-small")]),n("span",{class:[e.ramTextColor]},[e._v(e._s(e.ramDesc)+" ram")])],1),n("v-spacer"),n("v-tooltip",{attrs:{color:e.hostLedDesc[0],top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,s=t.attrs;return[n("v-btn",e._g(e._b({attrs:{icon:""}},"v-btn",s,!1),a),[n("v-icon",[e._v("mdi-table")])],1)]}}]),model:{value:e.tooltipModel,callback:function(t){e.tooltipModel=t},expression:"tooltipModel"}},[n("v-simple-table",{scopedSlots:e._u([{key:"default",fn:function(){return[n("thead",[n("tr",[n("th",{staticClass:"text-left"},[e._v("Service")]),n("th",{staticClass:"text-left"},[e._v("Type")]),n("th",{staticClass:"text-left"},[e._v("Monitor")]),n("th",{staticClass:"text-left"},[e._v("Status")])])]),n("tbody",e._l(e.hostServices,(function(t){return n("tr",{key:e.report.id+"-"+t.name},[n("td",[e._v(e._s(t.name))]),n("td",[e._v(e._s(t.type))]),n("td",[e._v(e._s(e.getServiceMonitorDesc(t.monitor)))]),n("td",[n("v-icon",{attrs:{small:"",color:e.getServiceStatusColor(t.status)}},[e._v(" mdi-circle-medium ")])],1)])})),0)]},proxy:!0}])})],1)],1)],1)},l=[],c=(n("99af"),n("b680"),n("bc3a")),d=n.n(c),u={props:["report"],data:function(){return{tooltipModel:!1,hostServices:[]}},watch:{tooltipModel:function(e){e&&this.__pre_fetch_services__()},report:{handler:function(e){e.alertMessage&&(this.hostServices=[])},deep:!0}},computed:{uptimeDesc:function(){var e=this.report.uptime;switch(!0){case e<60:return"".concat(e," secs");case e<3600:return"".concat((e/60).toFixed(1)," mins");case e<86400:return"".concat((e/3600).toFixed(1)," hrs");default:return"".concat((e/86400).toFixed(1)," days")}},pollTimeDesc:function(){var e=this.report.poll;switch(!0){case e<60:return"".concat(e," secs");case e<3600:return"".concat((e/60).toFixed(1)," mins");case e<86400:return"".concat((e/3600).toFixed(1)," hrs");default:return"".concat((e/86400).toFixed(1)," days")}},cpuDesc:function(){return this.report.cpu.toFixed(1)+"%"},ramDesc:function(){return this.report.ram.toFixed(1)+"%"},cpuTextColor:function(){var e="";switch(!0){case this.report.cpu<80:break;case this.report.cpu<95:e="amber--text";break;case this.report.cpu>=95:e="red--text";break}return e},ramTextColor:function(){var e="";switch(!0){case this.report.ram<80:break;case this.report.ram<95:e="amber--text";break;case this.report.ram>=95:e="red--text";break}return e},hostLedDesc:function(){var e="grey",t="mdi-loading",n="loading";return this.report.alertMessage?(e="red",t="mdi-message-alert"):this.report.services===this.report.failServices?(e="red",t="mdi-alert"):this.report.skipServices>=1||this.report.failServices>=1?(e="amber",t="mdi-alert"):this.report.services===this.report.goodServices&&(e="green",t="mdi-check-bold",n="good"),this.$emit("hostStateChanged",{id:this.report.id,status:n}),[e,t]}},created:function(){this.__pre_fetch_services__()},methods:{__pre_fetch_services__:function(){var e=this;if(!this.report.alertMessage){var t=this.report.id;d.a.get("".concat(this.$GCONFIG.api_base_url,"/api/hosts/").concat(t,"/report")).then((function(t){console.log("HostCard::__pre_fetch_services__() - get report response:",t),t.data.length>0&&(e.hostServices=[],t.data.forEach((function(t){e.hostServices.push(t)})))})).catch((function(e){console.log("HostCard::__pre_fetch_services__() - get report error:",e)}))}},getServiceStatusColor:function(e){switch(e){case 0:return"success";default:return"error"}},getServiceMonitorDesc:function(e){switch(e){case 1:return"Yes";case 0:return"No";case 2:return"Initializing...";default:return"UNKNOWN"}}}},h=u,p=n("2877"),v=n("6544"),m=n.n(v),f=n("8336"),b=n("b0af"),_=n("99d9"),g=n("62ad"),C=n("132d"),x=n("da13"),y=n("8270"),S=n("5d23"),w=n("0fd9"),T=n("1f4f"),A=n("2fa4"),E=n("3a2f"),k=Object(p["a"])(h,i,l,!1,null,null,null),O=k.exports;m()(k,{VBtn:f["a"],VCard:b["a"],VCardActions:_["a"],VCardText:_["b"],VCol:g["a"],VIcon:C["a"],VListItem:x["a"],VListItemAvatar:y["a"],VListItemContent:S["a"],VListItemSubtitle:S["b"],VListItemTitle:S["c"],VRow:w["a"],VSimpleTable:T["a"],VSpacer:A["a"],VTooltip:E["a"]});var R=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-dialog",{attrs:{value:!0,fullscreen:"","hide-overlay":"",transition:"dialog-bottom-transition"},on:{input:function(t){return e.$emit("closeDialog")}}},[n("v-card",[n("v-toolbar",{attrs:{outlined:""}},[n("v-btn",{attrs:{icon:""},on:{click:function(t){return e.$emit("closeDialog")}}},[n("v-icon",[e._v("mdi-close")])],1),n("v-toolbar-title",[e._v("Settings")]),n("v-spacer"),n("v-toolbar-items",[n("v-btn",{attrs:{text:""},on:{click:e.createSomethingNew}},[e._v(" Add new "),n("v-icon",{attrs:{right:""}},[e._v("mdi-plus-circle-outline")])],1)],1)],1),n("v-tabs",{attrs:{right:""},model:{value:e.currentTab,callback:function(t){e.currentTab=t},expression:"currentTab"}},[n("v-tab",{attrs:{href:"#tabAlertRule"}},[e._v("Alert Rules")]),n("v-tab",{attrs:{href:"#tabChannel"}},[e._v("Alert Channels")])],1),n("v-card-text",[n("v-tabs-items",{model:{value:e.currentTab,callback:function(t){e.currentTab=t},expression:"currentTab"}},[n("v-tab-item",{attrs:{value:"tabAlertRule"}},[n("TabViewAlertRule")],1),n("v-tab-item",{attrs:{value:"tabChannel"}},[n("TabViewChannel")],1),n("v-tab-item",{attrs:{value:"tabMailGroup"}},[e._v(" tabMailGroup ")])],1)],1)],1),e.showEditForm?n(e.currentEditForm,{tag:"component",on:{closeDialog:function(t){e.showEditForm=!1}}}):e._e()],1)},D=[],V=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[e._l(Math.ceil(e.alert_channels.length/3),(function(t){return n("v-row",{key:"row-"+t},[e._l(3,(function(a){return[3*(t-1)+(a-1)<e.alert_channels.length?n("v-col",{key:"col-"+t+"-"+a},[n("v-card",{attrs:{"min-height":"195","min-width":"195"}},[n("v-card-title",[n("v-icon",{attrs:{small:"",left:""}},[e._v(e._s(e.getChannelTypeIcon(e.alert_channels[3*(t-1)+(a-1)].type)))]),n("span",{staticClass:"text-subtitle-2 _d-inline-block _text-truncate",attrs:{_style:"cardTitleNameStyle"}},[e._v(e._s(e.alert_channels[3*(t-1)+(a-1)].name))]),n("v-spacer"),n("v-btn",{attrs:{icon:""},on:{click:function(n){e.editChannel(e.alert_channels[3*(t-1)+(a-1)])}}},[n("v-icon",{attrs:{small:""}},[e._v("mdi-pencil")])],1),n("v-btn",{attrs:{icon:""},on:{click:function(n){e.removeChannel(e.alert_channels[3*(t-1)+(a-1)].id)}}},[n("v-icon",{attrs:{small:""}},[e._v("mdi-delete")])],1)],1),1===e.alert_channels[3*(t-1)+(a-1)].type?n("v-card-text",[n("div",[n("span",{staticClass:"text-caption text--disabled"},[e._v("Sender")]),e._v(" "),n("span",{staticClass:"text-body-2"},[e._v(" "+e._s(e.alert_channels[3*(t-1)+(a-1)].customText)+" ")])]),n("div",[n("span",{staticClass:"text-caption text--disabled"},[e._v("Webhook URL")]),e._v(" "),n("span",{staticClass:"text-body-2"},[e._v(e._s(e.alert_channels[3*(t-1)+(a-1)].webhook_url))])])]):n("v-card-text",[n("div",[n("span",{staticClass:"text-caption text--disabled"},[e._v("Server")]),e._v(" "),n("span",{staticClass:"text-body-2"},[e._v(" "+e._s(e.alert_channels[3*(t-1)+(a-1)].host)+":"+e._s(e.alert_channels[3*(t-1)+(a-1)].port)+" ")])]),n("div",[n("span",{staticClass:"text-caption text--disabled"},[e._v("Sender")]),e._v(" "),n("span",{staticClass:"text-body-2"},[e._v(" "+e._s(e.alert_channels[3*(t-1)+(a-1)].customText)+" <"+e._s(e.alert_channels[3*(t-1)+(a-1)].senderAddress)+"> ")])]),e.smtpAuthEnable(e.alert_channels[3*(t-1)+(a-1)])?[n("div",[n("span",{staticClass:"text-caption text--disabled"},[e._v("Username")]),e._v(" "),n("span",{staticClass:"text-body-2"},[e._v(" "+e._s(e.alert_channels[3*(t-1)+(a-1)].user?e.alert_channels[3*(t-1)+(a-1)].user:"n/a")+" ")])]),n("div",[n("span",{staticClass:"text-caption text--disabled"},[e._v("Password")]),e._v(" "),n("span",{staticClass:"text-body-2"},[e._v(" "+e._s(e.alert_channels[3*(t-1)+(a-1)].passwd?e.alert_channels[3*(t-1)+(a-1)].passwd:"n/a")+" ")])])]:n("div",[n("span",{staticClass:"text-caption text--disabled"},[e._v("Auth")]),e._v(" "),n("span",{staticClass:"text-body-2"},[e._v("Not required")])])],2)],1)],1):e._e()]}))],2)})),e.showEditForm?n("TabEditorChannel",{attrs:{mode:"EDIT",channelPropObject:e.editedObject},on:{closeDialog:function(t){e.showEditForm=!1}}}):e._e(),e.showDeleteConfirm?n("ConfirmDialog",{on:{closeDialog:function(t){e.showDeleteConfirm=!1},agreeConfirm:e.processAgreeConfirm}}):e._e()],2)},L=[],P=(n("b0c0"),n("2f62")),N=n("5a4f"),j=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{attrs:{justify:"center"}},[n("v-dialog",{attrs:{value:!0,"max-width":"290"},on:{input:function(t){return e.$emit("closeDialog")}}},[n("v-card",[n("v-card-title",{staticClass:"text-subtitle-1"},[e._v("Delete this item?")]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:""},on:{click:function(t){return e.$emit("closeDialog")}}},[e._v("Close")]),n("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){return e.$emit("agreeConfirm")}}},[e._v("Agree")])],1)],1)],1)],1)},M=[],$={},I=$,F=n("169a"),H=Object(p["a"])(I,j,M,!1,null,null,null),G=H.exports;m()(H,{VBtn:f["a"],VCard:b["a"],VCardActions:_["a"],VCardTitle:_["c"],VDialog:F["a"],VRow:w["a"],VSpacer:A["a"]});var U={components:{TabEditorChannel:N["default"],ConfirmDialog:G},data:function(){return{showEditForm:!1,editedObject:{},showDeleteConfirm:!1}},computed:Object(r["a"])(Object(r["a"])({},Object(P["b"])(["alert_channels"])),{},{cardTitleNameStyle:function(){var e="max-width: 120px";switch(this.$vuetify.breakpoint.name){case"lg":e="max-width: 16vw";break;case"xl":e="max-width: 17vw";break}return e}}),created:function(){console.log("TabViewChannel::created()...")},methods:{getChannelTypeIcon:function(e){switch(e){case 1:return"mdi-slack";case 2:return"mdi-email"}},removeChannel:function(e){this.showDeleteConfirm=!0,this.deletionPayload={id:e}},processAgreeConfirm:function(){this.deletionPayload.id&&this.__remove_channel_helper__(this.deletionPayload.id),this.showDeleteConfirm=!1},__remove_channel_helper__:function(e){var t=this;console.log("TabViewChannel::removeChannel() with id:",e),d.a.delete("".concat(this.$GCONFIG.api_base_url,"/api/channels/").concat(e)).then((function(n){console.log("TabViewChannel::removeChannel() - get report response:",n),n.data&&("success"===n.data.status?t.$store.commit("REMOVE_ALERT_CHANNEL",e):console.warn("TabViewChannel::removeChannel() - something is wrongs at backend"))})).catch((function(e){console.log("TabViewChannel::removeChannel() - get report error:",e)}))},editChannel:function(e){this.showEditForm=!0,this.editedObject=e},smtpAuthEnable:function(e){return e.user&&e.passwd}}},B=U,W=n("a523"),J=Object(p["a"])(B,V,L,!1,null,null,null),K=J.exports;m()(J,{VBtn:f["a"],VCard:b["a"],VCardText:_["b"],VCardTitle:_["c"],VCol:g["a"],VContainer:W["a"],VIcon:C["a"],VRow:w["a"],VSpacer:A["a"]});var q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-simple-table",{attrs:{"fixed-header":"",height:"75vh"},scopedSlots:e._u([{key:"default",fn:function(){return[n("thead",[n("tr",[n("th",{staticClass:"text-left"},[e._v("Rule Name")]),n("th",{staticClass:"text-left"},[e._v("Filters")]),n("th",{staticClass:"text-left"},[e._v("Alert Configuration")]),n("th",{staticClass:"text-left"},[e._v("Actions")]),n("th",{staticClass:"text-left"},[e._v("Active")])])]),n("tbody",e._l(e.alertRules,(function(t,a){return n("tr",{key:"item.name"+a},[n("td",{staticClass:"text-caption"},[e._v(e._s(t.name))]),n("td",{staticClass:"text-caption",domProps:{innerHTML:e._s(e.getDisplayTextOfFilters(a))}}),n("td",{staticClass:"text-caption",domProps:{innerHTML:e._s(e.getDisplayTextOfAlertConf(a))}}),n("td",[n("v-btn",{attrs:{icon:""},on:{click:function(n){return e.editRow(t.id,a)}}},[n("v-icon",{attrs:{small:""}},[e._v("mdi-pencil")])],1),n("v-btn",{attrs:{icon:""},on:{click:function(n){return e.deleteRow(t.id,a)}}},[n("v-icon",{attrs:{small:""}},[e._v("mdi-delete")])],1)],1),n("td",[n("v-switch",{attrs:{dense:""},model:{value:t.active,callback:function(n){e.$set(t,"active",n)},expression:"item.active"}})],1)])})),0)]},proxy:!0}])}),e.showEditForm?n("TabEditorAlertRule",{attrs:{mode:"EDIT",alertRuleObject:e.editedObject},on:{closeDialog:function(t){e.showEditForm=!1}}}):e._e(),e.showDeleteConfirm?n("ConfirmDialog",{on:{closeDialog:function(t){e.showDeleteConfirm=!1},agreeConfirm:e.processAgreeConfirm}}):e._e()],1)},Y=[],z=(n("d81d"),n("a434"),n("ac1f"),n("1276"),n("bac9")),Q={components:{TabEditorAlertRule:z["default"],ConfirmDialog:G},data:function(){return{alertRules:[],showEditForm:!1,editedObject:{},showDeleteConfirm:!1,deletionPayload:{}}},computed:{ruleActiveArray:function(){return this.alertRules.map((function(e){return e.active}))}},watch:{ruleActiveArray:{handler:function(e,t){if(e.length===t.length){for(var n={index:-1,value:null},a=0;a<e.length;a++){var s=e[a],o=t[a];if(s!==o){n.value=s,n.index=a;break}}console.log("TabViewAlertRule::watch::ruleActiveArray - changed object:",JSON.stringify(n)),this.changeActiveState(n)}else console.log("TabViewAlertRule::watch::ruleActiveArray - skip inserted item or first load")},deep:!0}},created:function(){var e=this;d.a.get("".concat(this.$GCONFIG.api_base_url,"/api/alert-rules")).then((function(t){console.log("TabViewAlertRule::created() - api response:",t),t.data.length>0&&t.data.forEach((function(t){1===t.active?t.active=!0:t.active=!1,e.alertRules.push(t)}))})).catch((function(e){console.log("TabViewAlertRule::created() - api error:",e)}))},mounted:function(){it.$on("NEW_ALERT_RULE_INSERTED",this.__rule_insert_handler__),it.$on("NEW_ALERT_RULE_UPDATED",this.__rule_update_handler__)},beforeDestroy:function(){it.$off("NEW_ALERT_RULE_INSERTED",this.__rule_insert_handler__),it.$off("NEW_ALERT_RULE_UPDATED",this.__rule_update_handler__)},methods:{__rule_insert_handler__:function(e){e.active=!0,console.warn("TabViewAlertRule::__rule_insert_handler__() - item:",e),this.alertRules.splice(0,0,e)},__rule_update_handler__:function(e){console.warn("TabViewAlertRule::__rule_update_handler__() - item:",e),this.alertRules.forEach((function(t){t.id===e.id&&(t.name=e.name,t.filters=e.filters,t.alertConf=e.alertConf)}))},getDisplayTextOfFilters:function(e){var t=this.alertRules[e].filters,n="";return JSON.parse(t).forEach((function(e){if(1===e.services.length)n+='<span class="text--disabled">Host</span> '.concat(e.host,'<span class="text--disabled"> - Services</span> ').concat(e.services,"<br/>");else{var t="<ul>";e.services.forEach((function(e){t+="<li>".concat(e,"</li>")})),t+="</ul>",n+='<span class="text--disabled">Host</span> '.concat(e.host,'<span class="text--disabled"> - Services</span> ').concat(t)}})),n},getDisplayTextOfAlertConf:function(e){var t=JSON.parse(this.alertRules[e].alertConf),n="";return"SMTP"===t.type?(n='<span class="text--disabled">SMTP</span> '.concat(t.name,"<br/>"),n+='<span class="text--disabled">Receivers</span><br/>',n+="<ul>",t.smtpReceivers.split("\n").forEach((function(e){n+="<li>".concat(e,"</li>")})),n+="</ul>"):n='<span class="text--disabled">Slack webhook</span> '.concat(t.name),n},editRow:function(e,t){this.showEditForm=!0,this.editedObject=this.alertRules[t]},deleteRow:function(e,t){this.showDeleteConfirm=!0,this.deletionPayload={id:e,index:t}},processAgreeConfirm:function(){this.deletionPayload.id&&this.deletionPayload.index>=0&&this.__delete_row_helper__(this.deletionPayload.id,this.deletionPayload.index),this.showDeleteConfirm=!1},__delete_row_helper__:function(e,t){var n=this;d.a.delete("".concat(this.$GCONFIG.api_base_url,"/api/alert-rules/").concat(e)).then((function(e){console.log("TabViewAlertRule::deleteRow() - get report response:",e),e.data&&("success"===e.data.status?n.alertRules.splice(t,1):console.warn("TabViewAlertRule::deleteRow() - something is wrongs at backend"))})).catch((function(e){console.log("TabViewAlertRule::deleteRow() - get report error:",e)}))},changeActiveState:function(e){var t=e.index,n=e.value;console.log("TabViewAlertRule::changeActiveState() - index:",t,"- item:",n);var a=n?1:-1,s={headers:{"Content-Type":"text/plain"}};d.a.put("".concat(this.$GCONFIG.api_base_url,"/api/alert-rules/").concat(this.alertRules[t].id,"/active"),a,s).then((function(e){console.log("TabViewAlertRule::changeActiveState() - api response:",e),e.data&&"success"===!e.data.status&&console.warn("TabViewAlertRule::changeActiveState() - something is wrongs at backend")})).catch((function(e){console.log("TabViewAlertRule::changeActiveState() - api error:",e)}))}}},X=Q,Z=n("b73d"),ee=Object(p["a"])(X,q,Y,!1,null,null,null),te=ee.exports;m()(ee,{VBtn:f["a"],VIcon:C["a"],VSimpleTable:T["a"],VSwitch:Z["a"]});var ne={components:{TabViewChannel:K,TabViewAlertRule:te},data:function(){return{currentTab:"tabAlertRule",showEditForm:!1,currentEditForm:null}},mounted:function(){var e=this;d.a.get("".concat(this.$GCONFIG.api_base_url,"/api/channels")).then((function(t){console.log("Setting::mounted() - Get Channels response:",t),t.data.length>0?(e.$store.commit("PURGE_ALERT_CHANNEL"),t.data.forEach((function(t){e.$store.commit("ADD_ALERT_CHANNEL",t)}))):0===t.data.length&&e.$store.commit("PURGE_ALERT_CHANNEL")})).catch((function(e){console.log("Setting::mounted() - Get Channels error:",e)}))},methods:{createSomethingNew:function(){"tabChannel"===this.currentTab?(this.currentEditForm=function(){return Promise.resolve().then(n.bind(null,"5a4f"))},this.showEditForm=!0):"tabAlertRule"===this.currentTab&&(this.currentEditForm=function(){return Promise.resolve().then(n.bind(null,"bac9"))},this.showEditForm=!0)}}},ae=ne,se=n("71a3"),oe=n("c671"),re=n("fe57"),ie=n("aac8"),le=n("71d9"),ce=n("2a7f"),de=Object(p["a"])(ae,R,D,!1,null,null,null),ue=de.exports;m()(de,{VBtn:f["a"],VCard:b["a"],VCardText:_["b"],VDialog:F["a"],VIcon:C["a"],VSpacer:A["a"],VTab:se["a"],VTabItem:oe["a"],VTabs:re["a"],VTabsItems:ie["a"],VToolbar:le["a"],VToolbarItems:ce["a"],VToolbarTitle:ce["b"]});var he=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-dialog",{attrs:{value:!0,fullscreen:"","hide-overlay":"",transition:"dialog-bottom-transition"},on:{input:function(t){return e.$emit("closeDialog")}}},[n("v-card",[n("v-toolbar",{attrs:{outlined:"",flat:""}},[n("v-btn",{attrs:{icon:""},on:{click:function(t){return e.$emit("closeDialog")}}},[n("v-icon",[e._v("mdi-close")])],1),n("v-toolbar-title",[e._v("License")])],1),n("v-card-text",[n("v-banner",{attrs:{"two-line":"",_style:"margin-left: -24px; margin-right: -24px",icon:"mdi-certificate-outline","icon-color":"primary"},scopedSlots:e._u([{key:"actions",fn:function(){return[n("v-btn",{attrs:{text:""},on:{click:function(t){e.showRegisterDialog=!0}}},[e._v("Register")]),n("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){e.showPurchaseDialog=!0}}},[e._v("Purchase")])]},proxy:!0}])},[n("span",{domProps:{innerHTML:e._s(e.licenseInfo)}})]),n("div",{staticClass:"text-center text-h6 font-weight-bold mt-5"},[e._v("Pricing offers")]),n("div",{staticClass:"text-center text--disabled"},[e._v("One time cost - 7 days email support - Free bug fixes & minor version upgrades")]),n("v-simple-table",{attrs:{"_fixed-header":"",_height:"75vh"},scopedSlots:e._u([{key:"default",fn:function(){return[n("thead",[n("tr",[n("th",{staticClass:"text-left"},[e._v("Monit Agent Server")]),n("th",{staticClass:"text-left"},[e._v("Price")])])]),n("tbody",e._l(e.priceTable,(function(t){return n("tr",{key:t.name},[n("td",{staticClass:"text--disabled"},[e._v(e._s(t.name))]),n("td",{staticClass:"text--disabled"},[e._v(e._s(t.price))])])})),0)]},proxy:!0}])}),n("small",[e._v(" * If you need something not listed here, pls contact us at "),n("span",{staticClass:"font-weight-bold"},[e._v(e._s(e.VUE_APP_SUPPORT_EMAIL))])]),n("input",{attrs:{type:"hidden",id:"mailTo"},domProps:{value:e.VUE_APP_SUPPORT_EMAIL}}),n("v-btn",{attrs:{icon:"","x-small":""},on:{click:function(t){return e.MixClipboardCopy("mailTo")}}},[n("v-icon",{attrs:{"x-small":""}},[e._v("mdi-content-copy")])],1)],1)],1),e.showRegisterDialog?n("LicenseRegister",{on:{closeDialog:function(t){e.showRegisterDialog=!1}}}):e._e(),e.showPurchaseDialog?n("LicensePurchase",{on:{closeDialog:function(t){e.showPurchaseDialog=!1}}}):e._e()],1)},pe=[],ve=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-dialog",{attrs:{value:!0,"max-width":"600px"},on:{input:function(t){return e.$emit("closeDialog")}}},[n("v-card",[n("v-card-title",[n("span",{staticClass:"text-subtitle-2"},[e._v(" Register new License ")])]),n("v-card-text",[n("v-container",[n("v-row",{attrs:{justify:"center"}},[n("v-col",{attrs:{cols:"12"}},[e.apiErrorMessage?n("div",[n("v-alert",{attrs:{dense:"",type:"error",border:"left","colored-border":"",elevation:"1"}},[e._v(" "+e._s(e.apiErrorMessage)+" ")])],1):e._e(),n("v-textarea",{attrs:{label:"License content*",placeholder:e.licenseContentExample,filled:"",counter:"1024",hint:"New license will replace the old one completely, without accumulation","persistent-hint":"","_auto-grow":"",clearable:""},model:{value:e.modelLicense,callback:function(t){e.modelLicense=t},expression:"modelLicense"}})],1)],1)],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:""},on:{click:function(t){return e.$emit("closeDialog")}}},[e._v("Close")]),n("v-btn",{attrs:{text:"",color:"primary",disabled:e.disableSaveButton},on:{click:e.registerLicense}},[e._v("Save")])],1)],1)],1)},me=[],fe=(n("498a"),{data:function(){return{modelLicense:null,licenseContentExample:"-----CENTMONIT BEGIN LICENSE-----\nline 1\nline 2\nline 3\n-----CENTMONIT END LICENSE-----\n",apiErrorMessage:null}},computed:{disableSaveButton:function(){return!this.modelLicense}},methods:{registerLicense:function(){var e=this;this.modelLicense=this.modelLicense.trim(),console.log("LicenseRegister::registerLicense() - content:",this.modelLicense),this.apiErrorMessage=null,d.a.put("".concat(this.$GCONFIG.api_base_url,"/api/license"),this.modelLicense).then((function(t){console.log("LicenseRegister::registerLicense() - api response:",t),t.data&&("success"===t.data.status?(it.$emit("LICENSE_UPDATED",t.data.payload),e.$emit("closeDialog")):(e.apiErrorMessage="This license was declined.",console.warn("LicenseRegister::registerLicense() - something is wrongs at backend")))})).catch((function(e){console.log("LicenseRegister::registerLicense() - api error:",e)}))}}}),be=fe,_e=n("0798"),ge=n("a844"),Ce=Object(p["a"])(be,ve,me,!1,null,null,null),xe=Ce.exports;m()(Ce,{VAlert:_e["a"],VBtn:f["a"],VCard:b["a"],VCardActions:_["a"],VCardText:_["b"],VCardTitle:_["c"],VCol:g["a"],VContainer:W["a"],VDialog:F["a"],VRow:w["a"],VSpacer:A["a"],VTextarea:ge["a"]});var ye=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-dialog",{attrs:{value:!0,"max-width":"600px"},on:{input:function(t){return e.$emit("closeDialog")}}},[e.showPurchaseGuideline?n("v-card",[n("v-card-title",[n("span",{staticClass:"text-subtitle-2"},[e._v(" Purchase License ")])]),n("v-card-text",[n("v-container",[n("v-row",{attrs:{justify:"center"}},[n("v-col",{staticClass:"pb-0",attrs:{cols:"12"}},[n("p",{staticClass:"mb-0"},[e._v("Pls send a purchase email as the following, then we will contact you right back with payment methods & license key:")])]),n("v-col",{staticClass:"pt-0",attrs:{cols:"12"}},[n("input",{attrs:{type:"hidden",id:"mailTo"},domProps:{value:e.VUE_APP_SUPPORT_EMAIL}}),n("textarea",{staticStyle:{width:"0px",height:"0px"},attrs:{type:"text",id:"mailBody"},domProps:{value:e.generateEmailBody("\n")}}),n("p",[n("span",{staticClass:"text--disabled"},[e._v("Mail to")]),e._v(" "+e._s(e.VUE_APP_SUPPORT_EMAIL)+" "),n("v-btn",{attrs:{icon:"",small:""},on:{click:function(t){return e.MixClipboardCopy("mailTo")}}},[n("v-icon",{attrs:{small:""}},[e._v("mdi-content-copy")])],1)],1),n("p",[n("span",{staticClass:"text--disabled"},[e._v("Content")]),n("v-btn",{attrs:{icon:"",small:""},on:{click:function(t){return e.MixClipboardCopy("mailBody")}}},[n("v-icon",{attrs:{small:""}},[e._v("mdi-content-copy")])],1)],1),n("p",{domProps:{innerHTML:e._s(e.generateEmailBody("<br/>"))}})])],1)],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:""},on:{click:function(t){return e.$emit("closeDialog")}}},[e._v("Close")])],1)],1):n("v-card",[n("v-card-title",[n("span",{staticClass:"text-subtitle-2"},[e._v(" Purchase License ")])]),n("v-card-text",[n("v-container",[n("v-row",{attrs:{justify:"center"}},[n("v-col",{attrs:{cols:"12"}},[n("v-btn-toggle",{staticStyle:{width:"100%"},attrs:{rounded:"",borderless:"",dense:"",mandatory:""},model:{value:e.modelLicenseType,callback:function(t){e.modelLicenseType=t},expression:"modelLicenseType"}},[n("v-btn",{staticStyle:{width:"50%"},attrs:{small:"",value:"NEW"}},[n("span",[e._v("New")])]),n("v-btn",{staticStyle:{width:"50%"},attrs:{small:"",value:"UPGRADE"}},[n("span",[e._v("Upgrade")])])],1)],1),"NEW"===e.modelLicenseType?[n("v-col",{attrs:{cols:"8"}},[n("v-select",{attrs:{label:"Instance MAC*",items:e.instMacs,"item-value":"mac","persistent-hint":"",hint:"The MAC address of the CentMonit server that will be embeded to license key"},scopedSlots:e._u([{key:"selection",fn:function(t){return[e._v(" "+e._s(t.item.nic)+" - "+e._s(t.item.mac)+" ")]}},{key:"item",fn:function(t){return[e._v(" "+e._s(t.item.nic)+" - "+e._s(t.item.mac)+" ")]}}],null,!1,1536746684),model:{value:e.modelInstMac,callback:function(t){e.modelInstMac=t},expression:"modelInstMac"}})],1),n("v-col",{attrs:{cols:"4"}},[n("v-text-field",{attrs:{label:"Monit agents*",type:"number",clearable:""},model:{value:e.modelMonitAgents,callback:function(t){e.modelMonitAgents=t},expression:"modelMonitAgents"}})],1)]:[n("v-col",{attrs:{cols:"12"}},[n("v-textarea",{attrs:{label:"Current license content*",placeholder:e.licenseContentExample,_filled:"",counter:"1024",clearable:""},model:{value:e.modelLicense,callback:function(t){e.modelLicense=t},expression:"modelLicense"}})],1),n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{label:"Current agents*",type:"number",clearable:""},model:{value:e.modelCurrentMonitAgents,callback:function(t){e.modelCurrentMonitAgents=t},expression:"modelCurrentMonitAgents"}})],1),n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{label:"Additional agents*",type:"number",clearable:""},model:{value:e.modelMonitAgents,callback:function(t){e.modelMonitAgents=t},expression:"modelMonitAgents"}})],1)],n("v-col",{attrs:{cols:"12"}},[[n("span",{staticClass:"font-weight-bold",staticStyle:{"vertical-align":"middle"}},[e._v("Price:")]),n("span",{staticClass:"text-subtitle-1",staticStyle:{"vertical-align":"middle"}},[e._v(" $"+e._s(e.formatPrice(e.totalPrice))+" ")]),n("v-tooltip",{staticStyle:{"vertical-align":"middle"},attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,s=t.attrs;return[n("v-btn",e._g(e._b({attrs:{icon:"","x-small":""}},"v-btn",s,!1),a),[n("v-icon",{attrs:{small:""}},[e._v("mdi-table")])],1)]}}],null,!1,1872288500),model:{value:e.modelPriceDetail,callback:function(t){e.modelPriceDetail=t},expression:"modelPriceDetail"}},[n("v-simple-table",{scopedSlots:e._u([{key:"default",fn:function(){return[n("thead",[n("tr",[n("th",{staticClass:"text-left"},[e._v("Agent Server")]),n("th",{staticClass:"text-left"},[e._v("Price")]),n("th",{staticClass:"text-left"},[e._v("Amount")])])]),n("tbody",e._l(e.pricesTableDesc,(function(t,a){return n("tr",{key:a},[n("td",0===a?[e._v(" First "+e._s(t.agents)+" agents ")]:[e._v(" Next "+e._s(t.agents)+" agents ")]),n("td",[e._v(" $"+e._s(t.price)+" ")]),n("td",[e._v(" $"+e._s(t.amount+".00")+" ")])])})),0)]},proxy:!0}],null,!1,3383233787)})],1)],e.modelCurrentMonitAgents>0?[n("span",{staticClass:"text-subtitle-1",staticStyle:{"vertical-align":"middle"}},[e._v(" − $"+e._s(e.formatPrice(e.currentLicensePrice))+" ")]),n("v-tooltip",{staticStyle:{"vertical-align":"middle"},attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,s=t.attrs;return[n("v-btn",e._g(e._b({attrs:{icon:"","x-small":""}},"v-btn",s,!1),a),[n("v-icon",{attrs:{small:""}},[e._v("mdi-information-outline")])],1)]}}],null,!1,3669695723),model:{value:e.modelCurrentLicensePriceDetail,callback:function(t){e.modelCurrentLicensePriceDetail=t},expression:"modelCurrentLicensePriceDetail"}},[n("span",[e._v(" The cost of current license for "+e._s(e.modelCurrentMonitAgents)+" agents"),n("br"),e._v(" that you have already paid for ")])]),n("span",{staticClass:"text-subtitle-1",staticStyle:{"vertical-align":"middle"}},[e._v(" = $"+e._s(e.formatPrice(e.totalPrice-e.currentLicensePrice))+" ")]),n("v-tooltip",{staticStyle:{"vertical-align":"middle"},attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,s=t.attrs;return[n("v-btn",e._g(e._b({attrs:{icon:"","x-small":""}},"v-btn",s,!1),a),[n("v-icon",{attrs:{small:""}},[e._v("mdi-information-outline")])],1)]}}],null,!1,3669695723),model:{value:e.modelExtraLicensePriceDetail,callback:function(t){e.modelExtraLicensePriceDetail=t},expression:"modelExtraLicensePriceDetail"}},[n("span",[e._v(" Extra cost for "+e._s(e.modelMonitAgents)+" additional agents ")])])]:e._e()],2)],2)],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:""},on:{click:function(t){return e.$emit("closeDialog")}}},[e._v("Close")]),n("v-btn",{attrs:{text:"",color:"primary",disabled:e.disableFinishButton},on:{click:function(t){e.showPurchaseGuideline=!0}}},[e._v("Finish")])],1)],1)],1)},Se=[],we=(n("25f0"),n("5319"),{data:function(){return{VUE_APP_SUPPORT_EMAIL:"support@centmonit.com.vn"}},created:function(){},methods:{MixClipboardCopy:function(e){var t=document.getElementById(e);t.setAttribute("type","text"),t.select();var n=document.execCommand("copy");t.setAttribute("type","hidden"),n&&this.$toast.open({message:"Copied to clipboard",type:"default",duration:2e3})}}}),Te={mixins:[we],data:function(){return{modelLicenseType:"NEW",modelInstMac:null,modelCurrentMonitAgents:0,modelMonitAgents:0,instMacs:[],modelPriceDetail:!1,modelCurrentLicensePriceDetail:!1,modelExtraLicensePriceDetail:!1,pricesTableConst:[{agentNum:2,priceUnit:0},{agentNum:3,priceUnit:8},{agentNum:5,priceUnit:6},{agentNum:10,priceUnit:5},{agentNum:30,priceUnit:3},{agentNum:50,priceUnit:1}],currentLicensePrice:0,totalPrice:0,pricesTableDesc:[],modelLicense:null,licenseContentExample:"-----CENTMONIT BEGIN LICENSE-----\nline 1\nline 2\nline 3\n-----CENTMONIT END LICENSE-----\n",showPurchaseGuideline:!1}},computed:{disableFinishButton:function(){return"NEW"===this.modelLicenseType?!this.modelInstMac||this.modelMonitAgents<=0:!this.modelLicense||this.modelMonitAgents<=0},totalAgents:function(){return parseInt(this.modelMonitAgents,10)+("NEW"===this.modelLicenseType?0:parseInt(this.modelCurrentMonitAgents,10))}},watch:{modelLicenseType:function(){this.modelCurrentMonitAgents=0,this.modelMonitAgents=0},_modelMonitAgents:function(){var e=parseInt(this.modelMonitAgents,10)+("NEW"===this.modelLicenseType?0:parseInt(this.modelCurrentMonitAgents,10));console.log("LicensePurchase::modelMonitAgents() - calculate pricing for",e,"agents");var t=0;this.pricesTableDesc=[];for(var n=0;n<this.pricesTableConst.length;n++){var a=this.pricesTableConst[n];if(e>=a.agentNum){var s=a.agentNum*a.priceUnit;t+=s,e-=a.agentNum,this.pricesTableDesc.push({agents:a.agentNum,price:a.priceUnit,amount:s})}else if(e>0){var o=e*a.priceUnit;t+=o,this.pricesTableDesc.push({agents:e,price:a.priceUnit,amount:o}),e=0}}if(e>0){var r=this.pricesTableDesc[this.pricesTableDesc.length-1];this.pricesTableDesc[this.pricesTableDesc.length-1]={agents:r.agents+e,price:r.price,amount:(r.agents+e)*r.price},t=t-r.amount+(r.agents+e)*r.price}this.totalPrice=t},totalAgents:function(e){var t=0;this.pricesTableDesc=[];for(var n=0;n<this.pricesTableConst.length;n++){var a=this.pricesTableConst[n];if(e>=a.agentNum){var s=a.agentNum*a.priceUnit;t+=s,e-=a.agentNum,this.pricesTableDesc.push({agents:a.agentNum,price:a.priceUnit,amount:s})}else if(e>0){var o=e*a.priceUnit;t+=o,this.pricesTableDesc.push({agents:e,price:a.priceUnit,amount:o}),e=0}}if(e>0){var r=this.pricesTableDesc[this.pricesTableDesc.length-1];this.pricesTableDesc[this.pricesTableDesc.length-1]={agents:r.agents+e,price:r.price,amount:(r.agents+e)*r.price},t=t-r.amount+(r.agents+e)*r.price}this.totalPrice=t},modelCurrentMonitAgents:function(e){for(var t=0,n=[],a=0;a<this.pricesTableConst.length;a++){var s=this.pricesTableConst[a];if(e>=s.agentNum){var o=s.agentNum*s.priceUnit;t+=o,e-=s.agentNum,n.push({agents:s.agentNum,price:s.priceUnit,amount:o})}else if(e>0){var r=e*s.priceUnit;t+=r,n.push({agents:e,price:s.priceUnit,amount:r}),e=0}}if(e>0){var i=n[n.length-1];n[n.length-1]={agents:i.agents+e,price:i.price,amount:(i.agents+e)*i.price},t=t-i.amount+(i.agents+e)*i.price}this.currentLicensePrice=t}},created:function(){var e=this;d.a.get("".concat(this.$GCONFIG.api_base_url,"/api/instmacs")).then((function(t){console.log("LicensePurchase::created() - Get instmacs response:",t),t.data.length>0&&(e.instMacs=t.data)})).catch((function(e){console.log("LicensePurchase::created() - Get instmacs error:",e)}))},methods:{priceDetailClickHandler:function(){this.showPriceDetail=!this.showPriceDetail},formatPrice:function(e){var t=(e/1).toFixed(2);return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},generateEmailBody:function(e){console.warn("this.modelLicense:",this.modelLicense);var t=null;return t="NEW"===this.modelLicenseType?"//===== PURCHASE INFO =====//".concat(e,"Type: NEW").concat(e,"Inst. MAC: ").concat(this.modelInstMac).concat(e,"Agents: ").concat(this.modelMonitAgents).concat(e,"//===== END =====//"):"//===== PURCHASE INFO =====//".concat(e,"Type: UPGRADE").concat(e,"Additional agents: ").concat(this.modelMonitAgents).concat(e,"//===== OLD LICENSE =====//").concat(e).concat(this.modelLicense.trim().replace(/\n/g,e)).concat(e,"//===== END =====//"),t}}},Ae=Te,Ee=n("a609"),ke=n("b974"),Oe=n("8654"),Re=Object(p["a"])(Ae,ye,Se,!1,null,null,null),De=Re.exports;m()(Re,{VBtn:f["a"],VBtnToggle:Ee["a"],VCard:b["a"],VCardActions:_["a"],VCardText:_["b"],VCardTitle:_["c"],VCol:g["a"],VContainer:W["a"],VDialog:F["a"],VIcon:C["a"],VRow:w["a"],VSelect:ke["a"],VSimpleTable:T["a"],VSpacer:A["a"],VTextField:Oe["a"],VTextarea:ge["a"],VTooltip:E["a"]});var Ve={components:{LicenseRegister:xe,LicensePurchase:De},mixins:[we],data:function(){return{priceTable:[{name:"First 2 agents",price:"Free... forever!"},{name:"Next 3 agents",price:"$8.00 / agent"},{name:"Next 5 agents",price:"$6.00 / agent"},{name:"Next 10 agents",price:"$5.00 / agent"},{name:"Next 30 agents",price:"$3.00 / agent"},{name:"Over 50 agents",price:"$1.00 / agent"}],showRegisterDialog:!1,licensePayload:null,showPurchaseDialog:!1}},computed:{licenseInfo:function(){return console.log("... calculated"),this.licensePayload?'PREMIUM - <span class="text--disabled">Inst. Mac</span>\n        '.concat(this.licensePayload.instMacAddr,' - <span class="text--disabled">Num. Agents</span>\n        ').concat(this.licensePayload.agents):"FREE"}},mounted:function(){it.$on("LICENSE_UPDATED",this.__license_update_handler__)},beforeDestroy:function(){it.$off("LICENSE_UPDATED",this.__license_update_handler__)},created:function(){var e=this;d.a.get("".concat(this.$GCONFIG.api_base_url,"/api/license")).then((function(t){if(console.log("License::created() - get license response:",t),t.data){var n=t.data;"premium"===n.type&&(e.licensePayload={},e.licensePayload.instMacAddr=n.payload.instMacAddr,e.licensePayload.agents=n.payload.agents)}})).catch((function(e){console.log("License::created() - get license error:",e)}))},methods:{__license_update_handler__:function(e){console.log("License::__license_update_handler__() - payload:",e),this.licensePayload=e}}},Le=Ve,Pe=n("e4e5"),Ne=Object(p["a"])(Le,he,pe,!1,null,null,null),je=Ne.exports;m()(Ne,{VBanner:Pe["a"],VBtn:f["a"],VCard:b["a"],VCardText:_["b"],VDialog:F["a"],VIcon:C["a"],VSimpleTable:T["a"],VToolbar:le["a"],VToolbarTitle:ce["b"]});var Me={name:"App",components:{HostCard:O,Setting:ue,License:je},data:function(){return{APP_VERSION:"2020.0-beta3",num:1,apiError:!1,apiErrorMessage:null,skeletonLoading:!0,drawer:!1,drawerRight:!1,alertSheet:!1,alertCount:0,alertEvents:[],items:[{title:"Dashboard",icon:"mdi-view-dashboard"},{title:"Photos",icon:"mdi-image"},{title:"About",icon:"mdi-help-box"}],socketConnection:null,socketConnected:!1,btnSocketReconnectLoading:!1,hostsReport:[],lastHostsReportTime:null,lastReportTimeStyleClass:"",hostsState:{},hostsNextReportTime:{},showSettingDialog:!1,showLicenseDialog:!1}},computed:Object(r["a"])(Object(r["a"])({},Object(P["b"])(["app_dark_mode","alert_messages"])),{},{hideAlertBadge:function(){return 0==this.alertCount&&this.socketConnected},alertBadgeIconProp:function(){return this.socketConnected?"":{icon:"mdi-close"}},socketConnectionStatusDesc:function(){return this.socketConnected?"connected":"not connect"},socketStatusStyleClass:function(){return this.socketConnected?"text-caption green--text":"text-caption red--text"}}),watch:{alertCount:function(e){document.title=0==e?"CentMonit":e<99?"(".concat(e,") CentMonit"):"(99+) CentMonit"}},created:function(){var e=this;console.log("App::created()..."),this.$vuetify.theme.dark=this.app_dark_mode,d.a.get("".concat(this.$GCONFIG.api_base_url,"/api/hosts/report")).then((function(t){console.log("App::created() - get report response:",t),e.hostsReport=t.data,e.lastHostsReportTime=new Date,e.hostsReport.forEach((function(t){e.$store.commit("ADD_HOST",t.hostname),t.alertMessage||e.$set(e.hostsNextReportTime,t.id,(new Date).getTime()+1e3*t.poll)}))})).catch((function(t){console.log("App::created() - get report error:",t),e.apiError=!0,e.apiErrorMessage=t.message})).finally((function(){setTimeout((function(){e.skeletonLoading=!1}),1500)})),this.__init_socket_connection__()},mounted:function(){var e=this;console.log("App:mounted()...");var t="bgJobID",n=localStorage.getItem(t);n&&(clearInterval(parseInt(n,10)),console.log("Cleared background job with id",n)),n=setInterval((function(){var t=e.hostsNextReportTime;Object.keys(t).forEach((function(n){var a=t[n],s=(new Date).getTime();s>a&&e.hostsReport.forEach((function(t){t.id===n&&(console.warn("No report from ",n,"-",t.hostname),t.alertMessage="No report within poll cycle",e.socketConnected||console.warn("Pls check socket connection..."))}))}))}),3e4),localStorage.setItem(t,n),console.log("Saved background job with id",n)},methods:{__highlight_report_time_text__:function(){var e=this;this.lastReportTimeStyleClass="blinking",setTimeout((function(){e.lastReportTimeStyleClass=""}),3500)},__init_socket_connection__:function(){var e=this;this.socketConnection=new WebSocket(this.$GCONFIG.socket_url),this.socketConnection.onopen=function(){console.log("App::socket::onopen..."),e.socketConnected=!0,e.btnSocketReconnectLoading&&(e.btnSocketReconnectLoading=!1)},this.socketConnection.onerror=function(){console.error("App::socket::error..."),e.btnSocketReconnectLoading&&(e.btnSocketReconnectLoading=!1,e.$toast.open({message:"Could not establish socket connection",type:"error"}))},this.socketConnection.onclose=function(){console.error("App::socket::close..."),e.socketConnected=!1},this.socketConnection.onmessage=function(t){var n=JSON.parse(t.data);if("EVENT"===n.channel)e.alertSheet||e.alertCount++,n["time"]=new Date,e.$store.commit("ADD_ALERT_MESSAGE",n),"Monit"===n.service&&e.hostsReport.forEach((function(t){t.hostname===n.host&&("error"===n.type?(t.alertMessage=n.message,delete e.hostsNextReportTime[t.id]):"success"===n.type&&(t.alertMessage=""))}));else if("HOST"===n.channel){e.lastHostsReportTime=new Date,e.__highlight_report_time_text__();for(var a=!1,s=0;s<e.hostsReport.length;s++){var o=e.hostsReport[s];if(o.id===n.id){o.poll=n.poll,o.uptime=n.uptime,o.ram=n.ram,o.cpu=n.cpu,o.services=n.services,o.goodServices=n.goodServices,o.failServices=n.failServices,o.skipServices=n.skipServices,o.alertMessage="",e.$set(e.hostsNextReportTime,n.id,(new Date).getTime()+1e3*o.poll),a=!0;break}}a||(e.hostsReport.push({id:n.id,poll:n.poll,hostname:n.hostname,uptime:n.uptime,ram:n.ram,cpu:n.cpu,services:n.services,goodServices:n.goodServices,failServices:n.failServices,skipServices:n.skipServices}),e.$set(e.hostsNextReportTime,n.id,(new Date).getTime()+1e3*n.poll),e.$store.commit("ADD_HOST",n.hostname))}}},test:function(){var e="".concat(this.num," Lorem ipsum dolor sit amet consectetur, adipisicing elit<br/>\n        Amet nulla obcaecati laudantium assumenda autem ex qui, non quisquam alias officia?<br/>\n        Neque nulla libero corporis eos atque facilis illum aliquid inventore?");this.num%3==0?this.$toast.open({message:e,type:"error"}):this.$toast.open({message:e}),this.num++},changeDarkMode:function(){var e=!this.app_dark_mode;this.$vuetify.theme.dark=e,this.$store.commit("SET_DARK_MODE",e)},openAlertSheet:function(){this.alertCount=0,this.alertSheet=!this.alertSheet},getAlertColor:function(e){switch(e){case"info":return"info";case"success":return"success";case"error":return"error";case"warning":return"warning";default:return""}},alertReset:function(){this.alertCount=0,this.$store.commit("CLEAR_ALERT_MESSAGES")},reconnectSocket:function(){console.log("App::reconnectSocket()..."),this.btnSocketReconnectLoading=!0,this.__init_socket_connection__()},totalGoodHosts:function(){var e=this;return Object.keys(this.hostsState).filter((function(t){return"good"===e.hostsState[t]})).length},onHostStateChanged:function(e){console.log("App::onHostStateChanged() - payload:",e),this.$set(this.hostsState,e.id,e.status)}}},$e=Me,Ie=(n("dcc0"),n("7496")),Fe=n("40dc"),He=n("5bc1"),Ge=n("4ca6"),Ue=n("288c"),Be=n("ce7e"),We=n("553a"),Je=n("f6c4"),Ke=n("3129"),qe=Object(p["a"])($e,s,o,!1,null,"a29a4598",null),Ye=qe.exports;m()(qe,{VAlert:_e["a"],VApp:Ie["a"],VAppBar:Fe["a"],VAppBarNavIcon:He["a"],VBadge:Ge["a"],VBanner:Pe["a"],VBottomSheet:Ue["a"],VBtn:f["a"],VCard:b["a"],VCardText:_["b"],VCardTitle:_["c"],VCol:g["a"],VContainer:W["a"],VDivider:Be["a"],VFooter:We["a"],VIcon:C["a"],VMain:Je["a"],VRow:w["a"],VSkeletonLoader:Ke["a"],VSpacer:A["a"],VToolbarTitle:ce["b"],VTooltip:E["a"]});var ze=n("8c4f");a["default"].use(ze["a"]);var Qe=[{path:"/",name:"route-dashboard"},{path:"/setting",name:"route-setting-page",component:function(){return n.e("about").then(n.bind(null,"e80b"))}}],Xe=new ze["a"]({mode:"history",base:"/",routes:Qe}),Ze=Xe,et=(n("c975"),n("bfa9"));a["default"].use(P["a"]);var tt=new et["a"]({key:"app-store",storage:window.localStorage,reducer:function(e){return{app_dark_mode:e.app_dark_mode,alert_messages:e.alert_messages}}}),nt=new P["a"].Store({plugins:[tt.plugin],state:{app_dark_mode:!1,alert_messages:[],hostnames:[],alert_channels:[]},mutations:{SET_DARK_MODE:function(e,t){e.app_dark_mode=t},ADD_ALERT_MESSAGE:function(e,t){var n=99;e.alert_messages.splice(0,0,t),e.alert_messages.length>n&&e.alert_messages.pop()},CLEAR_ALERT_MESSAGES:function(e){e.alert_messages=[]},ADD_HOST:function(e,t){-1===e.hostnames.indexOf(t)&&e.hostnames.splice(0,0,t)},PURGE_ALERT_CHANNEL:function(e){e.alert_channels=[]},ADD_ALERT_CHANNEL:function(e,t){e.alert_channels.splice(0,0,t)},REMOVE_ALERT_CHANNEL:function(e,t){for(var n=0;n<e.alert_channels.length;n++)if(e.alert_channels[n].id===t){e.alert_channels.splice(n,1);break}},UPDATE_ALERT_CHANNEL:function(e,t){for(var n=0;n<e.alert_channels.length;n++)if(e.alert_channels[n].id===t.id){a["default"].set(e.alert_channels,n,t);break}}},getters:{host_array:function(e){return e.hostnames},slack_iwh_alert_channel:function(e){var t=[];return e.alert_channels.forEach((function(e){1===e.type&&t.push({id:e.id,name:e.name})})),t},smtp_alert_channel:function(e){var t=[];return e.alert_channels.forEach((function(e){2===e.type&&t.push({id:e.id,name:e.name})})),t}},actions:{},modules:{}}),at=n("f309");a["default"].use(at["a"]);var st=new at["a"]({theme:{}}),ot=n("b079"),rt=n.n(ot);n("ce8c");a["default"].config.productionTip=!1;var it=new a["default"];a["default"].use(rt.a,{type:"success",position:"bottom",duration:5e3,pauseOnHover:!0}),d.a.get("/config.json").then((function(e){console.log("main() get config response:",e.data),a["default"].prototype.$GCONFIG=e.data,new a["default"]({router:Ze,store:nt,vuetify:st,render:function(e){return e(Ye)}}).$mount("#app")}))},"5a4f":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-dialog",{attrs:{value:!0,"max-width":"600px"},on:{input:function(t){return e.$emit("closeDialog")}}},[n("v-card",[n("v-card-title",[n("span",{staticClass:"text-subtitle-2"},[e._v(" "+e._s("NEW"===e.mode?"New Channel":"Edit Channel")+" ")])]),n("v-card-text",[n("v-form",{model:{value:e.formValid,callback:function(t){e.formValid=t},expression:"formValid"}},[n("v-container",[n("v-row",{attrs:{justify:"center"}},[n("v-col",{attrs:{cols:"12"}},[n("v-text-field",{attrs:{label:"Name*",disabled:"EDIT"===e.mode,clearable:""},model:{value:e.channelObj.name,callback:function(t){e.$set(e.channelObj,"name",t)},expression:"channelObj.name"}})],1),n("v-col",{attrs:{cols:"12"}},[e.enableEditChannelType?n("v-btn-toggle",{staticStyle:{width:"100%"},attrs:{rounded:"",borderless:"",dense:"",mandatory:""},model:{value:e.channelObj.type,callback:function(t){e.$set(e.channelObj,"type",t)},expression:"channelObj.type"}},[n("v-btn",{staticStyle:{width:"50%"},attrs:{small:"",value:"SLACK_WEBHOOKS"}},[n("span",{staticClass:"hidden-xs-only"},[e._v("Slack incoming webhooks")]),n("span",{staticClass:"hidden-sm-and-up"},[e._v("Slack")])]),n("v-btn",{staticStyle:{width:"50%"},attrs:{small:"",value:"SMTP"}},[n("span",{staticClass:"hidden-xs-only"},[e._v("SMTP mail server")]),n("span",{staticClass:"hidden-sm-and-up"},[e._v("SMTP")])])],1):e._e()],1),"SMTP"===e.channelObj.type?[n("v-col",{attrs:{cols:"12",sm:"6"}},[n("v-text-field",{attrs:{label:"Server hostname or IP*",clearable:""},model:{value:e.channelObj.host,callback:function(t){e.$set(e.channelObj,"host",t)},expression:"channelObj.host"}})],1),n("v-col",{attrs:{cols:"12",sm:"6"}},[n("v-text-field",{attrs:{label:"Server port*",type:"number",clearable:""},model:{value:e.channelObj.port,callback:function(t){e.$set(e.channelObj,"port",t)},expression:"channelObj.port"}})],1),n("v-col",{attrs:{cols:"12"}},[n("v-text-field",{attrs:{label:"Sender address*",clearable:""},model:{value:e.channelObj.senderAddress,callback:function(t){e.$set(e.channelObj,"senderAddress",t)},expression:"channelObj.senderAddress"}})],1),n("v-col",{attrs:{cols:"8",sm:"8"}},[n("v-text-field",{attrs:{label:"Sender name*",clearable:"","persistent-hint":!0,hint:"Use this field to differentiate alert messages from different Systems/Datacenters"},model:{value:e.channelObj.customText,callback:function(t){e.$set(e.channelObj,"customText",t)},expression:"channelObj.customText"}})],1),n("v-col",{attrs:{cols:"4",sm:"4"}},[n("v-switch",{attrs:{label:"Authentication",dense:""},model:{value:e.channelObj.authEnable,callback:function(t){e.$set(e.channelObj,"authEnable",t)},expression:"channelObj.authEnable"}})],1),e.channelObj.authEnable?n("v-col",{attrs:{cols:"12",sm:"6"}},[n("v-text-field",{attrs:{label:"Username*",clearable:""},model:{value:e.channelObj.user,callback:function(t){e.$set(e.channelObj,"user",t)},expression:"channelObj.user"}})],1):e._e(),e.channelObj.authEnable?n("v-col",{attrs:{cols:"12",sm:"6"}},[n("v-text-field",{attrs:{label:"Password*",clearable:""},model:{value:e.channelObj.passwd,callback:function(t){e.$set(e.channelObj,"passwd",t)},expression:"channelObj.passwd"}})],1):e._e()]:[n("v-col",{attrs:{cols:"12"}},[n("v-text-field",{attrs:{label:"Sender Name*",clearable:"","persistent-hint":!0,hint:"Use this field to differentiate alert messages from different Systems/Datacenters"},model:{value:e.channelObj.customText,callback:function(t){e.$set(e.channelObj,"customText",t)},expression:"channelObj.customText"}})],1),n("v-col",{attrs:{cols:"12"}},[n("v-text-field",{attrs:{label:"Webhook URL*","append-icon":"mdi-help-circle-outline","persistent-hint":!0,hint:"Click help icon on the right for Slack webhook tutorial",clearable:""},on:{"click:append":e.openSlackWebhookHelp},model:{value:e.channelObj.webhook_url,callback:function(t){e.$set(e.channelObj,"webhook_url",t)},expression:"channelObj.webhook_url"}})],1)]],2)],1)],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:""},on:{click:function(t){return e.$emit("closeDialog")}}},[e._v("Close")]),n("v-btn",{attrs:{text:"",color:"primary",disabled:e.disableSaveButton},on:{click:e.saveChannel}},[e._v("Save")])],1)],1)],1)},s=[],o=(n("99af"),n("b0c0"),n("498a"),n("5530")),r=n("bc3a"),i=n.n(r),l={props:{mode:{type:String,default:"NEW"},channelPropObject:Object},data:function(){return{formValid:!1,channelObj:{name:"Default channel",type:"SLACK_WEBHOOKS",webhook_url:null,host:"smtp.gmail.com",port:587,ssl:!0,user:null,passwd:null,authEnable:!1,customText:"CentMonit",senderAddress:"example@email.com"}}},computed:{enableEditChannelType:function(){return"NEW"===this.mode},disableSaveButton:function(){return"SLACK_WEBHOOKS"===this.channelObj.type?!this.channelObj.name||!this.channelObj.webhook_url||!this.channelObj.customText:!this.channelObj.name||!this.channelObj.customText||!this.channelObj.senderAddress||!this.channelObj.host||!this.channelObj.port||this.channelObj.authEnable&&(!this.channelObj.user||!this.channelObj.passwd)}},created:function(){"EDIT"===this.mode&&(this.channelObj.name=this.channelPropObject.name,this.channelObj.customText=this.channelPropObject.customText,1===this.channelPropObject.type?(this.channelObj.type="SLACK_WEBHOOKS",this.channelObj.webhook_url=this.channelPropObject.webhook_url):(this.channelObj.type="SMTP",this.channelObj.host=this.channelPropObject.host,this.channelObj.port=this.channelPropObject.port,this.channelObj.user=this.channelPropObject.user,this.channelObj.passwd=this.channelPropObject.passwd,this.channelObj.authEnable=Boolean(this.channelPropObject.user)&&Boolean(this.channelPropObject.passwd),this.channelObj.senderAddress=this.channelPropObject.senderAddress))},methods:{saveChannel:function(){var e=this;console.log("TabEditorChannel::saveChannel() obj:",JSON.stringify(this.channelObj));var t=Object(o["a"])({},this.channelObj);"string"===typeof t.port&&(t.port=parseInt(t.port,10)),t.type="SLACK_WEBHOOKS"===t.type?1:2,t.authEnable?(t.user=t.user.trim(),t.passwd=t.passwd.trim()):(t.user=null,t.passwd=null),t.host&&(t.host=t.host.trim()),t.webhook_url&&(t.webhook_url=t.webhook_url.trim()),"NEW"===this.mode?i.a.post("".concat(this.$GCONFIG.api_base_url,"/api/channels"),t).then((function(n){console.log("TabEditorChannel::saveChannel() - create response:",n),n.data&&("success"===n.data.status?(t.id=n.data.id,e.$store.commit("ADD_ALERT_CHANNEL",t),e.$emit("closeDialog")):console.warn("TabEditorChannel::saveChannel() - something is wrongs at backend when create"))})).catch((function(e){console.log("TabEditorChannel::saveChannel() - create error:",e)})):i.a.put("".concat(this.$GCONFIG.api_base_url,"/api/channels/").concat(this.channelPropObject.id),t).then((function(n){if(console.log("TabEditorChannel::saveChannel() - update response:",n),n.data)if("success"===n.data.status){var a=Object(o["a"])({id:e.channelPropObject.id},t);e.$store.commit("UPDATE_ALERT_CHANNEL",a),e.$emit("closeDialog")}else console.warn("TabEditorChannel::saveChannel() - something is wrongs at backend when update")})).catch((function(e){console.log("TabEditorChannel::saveChannel() - update error:",e)}))},openSlackWebhookHelp:function(){window.open("https://slack.com/intl/en-vn/help/articles/115005265063-Incoming-Webhooks-for-Slack","_blank")}}},c=l,d=n("2877"),u=n("6544"),h=n.n(u),p=n("8336"),v=n("a609"),m=n("b0af"),f=n("99d9"),b=n("62ad"),_=n("a523"),g=n("169a"),C=n("4bd4"),x=n("0fd9"),y=n("2fa4"),S=n("b73d"),w=n("8654"),T=Object(d["a"])(c,a,s,!1,null,null,null);t["default"]=T.exports;h()(T,{VBtn:p["a"],VBtnToggle:v["a"],VCard:m["a"],VCardActions:f["a"],VCardText:f["b"],VCardTitle:f["c"],VCol:b["a"],VContainer:_["a"],VDialog:g["a"],VForm:C["a"],VRow:x["a"],VSpacer:y["a"],VSwitch:S["a"],VTextField:w["a"]})},bac9:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-dialog",{attrs:{value:!0,"min-width":"90vw"},on:{input:function(t){return e.$emit("closeDialog")}}},[n("v-stepper",{model:{value:e.currentStep,callback:function(t){e.currentStep=t},expression:"currentStep"}},[n("v-stepper-header",[n("v-stepper-step",{attrs:{complete:e.currentStep>1,step:"1"}},[e._v("Rule name")]),n("v-divider"),n("v-stepper-step",{attrs:{complete:e.currentStep>2,step:"2"}},[e._v("Filters")]),n("v-divider"),n("v-stepper-step",{attrs:{step:"3"}},[e._v("Alert configuration")])],1),n("v-stepper-items",[n("v-stepper-content",{attrs:{step:"1"}},[n("v-form",[n("v-container",[n("v-row",{attrs:{justify:"center"}},[n("v-col",{attrs:{md:"4",sm:"12"}},[n("v-text-field",{attrs:{label:"Rule name*",clearable:""},model:{value:e.ruleName,callback:function(t){e.ruleName=t},expression:"ruleName"}})],1)],1)],1)],1),n("v-btn",{attrs:{text:"",color:"primary",disabled:e.disableStep2},on:{click:function(t){e.currentStep=2}}},[e._v("Next")]),n("v-btn",{attrs:{text:""},on:{click:function(t){return e.$emit("closeDialog")}}},[e._v("Close")])],1),n("v-stepper-content",{attrs:{step:"2"}},[n("v-form",[n("v-container",[n("v-row",{attrs:{justify:"center"}},[n("v-col",{staticClass:"text-center"},[e.filters.length>1?n("small",[e._v(" These "+e._s(e.filters.length)+" filters will be combinated by "),n("strong",[e._v("OR")]),e._v(" operator. ")]):n("small",[e._v(" If the server's hostname or the service's name was changed, you need to reconfig this filter. ")])])],1),e._l(e.filters,(function(t,a){return n("v-row",{key:a,attrs:{justify:"center",align:"center"}},[n("v-col",{attrs:{md:"4",sm:"5",cols:"12"}},[n("v-combobox",{attrs:{label:"Host",dense:"",items:e.selectionHostItems,clearable:""},model:{value:t.modelHost,callback:function(n){e.$set(t,"modelHost",n)},expression:"filter.modelHost"}})],1),n("v-col",{attrs:{md:"4",sm:"5",cols:"10"}},[n("v-combobox",{attrs:{label:"Service(s)",dense:"",items:t.services,"small-chips":"",multiple:"","hide-selected":"","search-input":t.serviceSearchText,disabled:t.disableService,hint:"Type or select from list","persistent-hint":"",clearable:""},on:{"update:searchInput":function(n){return e.$set(t,"serviceSearchText",n)},"update:search-input":function(n){return e.$set(t,"serviceSearchText",n)}},scopedSlots:e._u([{key:"no-data",fn:function(){return[n("v-list-item",[n("v-list-item-content",[n("v-list-item-title",[e._v(' No results matching "'),n("strong",[e._v(e._s(t.serviceSearchText))]),e._v('", press '),n("code",[e._v("enter")]),e._v(" to create a new one. ")])],1)],1)]},proxy:!0}],null,!0),model:{value:t.modelService,callback:function(n){e.$set(t,"modelService",n)},expression:"filter.modelService"}})],1),n("v-col",{attrs:{md:"2"}},[a===e.filters.length-1?n("v-btn",{attrs:{icon:"",small:"",disabled:"All"===e.firstHostModel},on:{click:e.addEventFilter}},[n("v-icon",{attrs:{small:"",color:"primary"}},[e._v("mdi-plus-circle")])],1):n("v-btn",{attrs:{icon:"",small:""},on:{click:function(t){return e.removeEventFilter(a)}}},[n("v-icon",{attrs:{small:"",color:"primary"}},[e._v("mdi-minus-circle")])],1)],1)],1)}))],2)],1),n("v-btn",{attrs:{text:"",color:"primary",disabled:e.disableStep3},on:{click:function(t){e.currentStep=3}}},[e._v("Next")]),n("v-btn",{attrs:{text:""},on:{click:function(t){return e.$emit("closeDialog")}}},[e._v("Close")])],1),n("v-stepper-content",{attrs:{step:"3"}},[n("v-form",[n("v-container",[n("v-row",{attrs:{justify:"center"}},[n("v-col",{attrs:{md:"4",sm:"6",cols:"12"}},[n("v-select",{attrs:{label:"Alert channel*",items:e.alertChannels,clearable:""},model:{value:e.modelAlertChannel.type,callback:function(t){e.$set(e.modelAlertChannel,"type",t)},expression:"modelAlertChannel.type"}})],1),n("v-col",{attrs:{md:"4",sm:"6",cols:"12"}},["Slack Webhook"===e.modelAlertChannel.type?n("v-select",{attrs:{label:"Choose a channel",items:e.$store.getters.slack_iwh_alert_channel,"item-text":"name","item-value":"id"},model:{value:e.modelAlertChannel.value,callback:function(t){e.$set(e.modelAlertChannel,"value",t)},expression:"modelAlertChannel.value"}}):"SMTP"===e.modelAlertChannel.type?n("v-select",{attrs:{label:"Choose a channel",items:e.$store.getters.smtp_alert_channel,"item-text":"name","item-value":"id"},model:{value:e.modelAlertChannel.value,callback:function(t){e.$set(e.modelAlertChannel,"value",t)},expression:"modelAlertChannel.value"}}):e._e()],1),"SMTP"===e.modelAlertChannel.type?n("v-col",{attrs:{md:"8",cols:"12"}},[n("v-textarea",{attrs:{label:"Receiver(s)",placeholder:"user@email.com",hint:"Email addresses are separated by enter (newline) character","persistent-hint":"",clearable:""},model:{value:e.modelAlertChannel.smtpReceivers,callback:function(t){e.$set(e.modelAlertChannel,"smtpReceivers",t)},expression:"modelAlertChannel.smtpReceivers"}})],1):e._e()],1)],1)],1),n("v-btn",{attrs:{text:"",color:"primary",disabled:e.disableSave},on:{click:e.saveRule}},[e._v("Save")]),n("v-btn",{attrs:{text:""},on:{click:function(t){return e.$emit("closeDialog")}}},[e._v("Close")])],1)],1)],1)],1)},s=[],o=(n("99af"),n("4160"),n("c975"),n("d81d"),n("a434"),n("b0c0"),n("159b"),n("5530")),r=(n("96cf"),n("1da1")),i=n("bc3a"),l=n.n(i),c=n("56d7"),d={props:{mode:{type:String,default:"NEW"},alertRuleObject:Object},data:function(){return{currentStep:1,ruleName:"Default rule",filters:[{modelHost:null,modelService:[],disableService:!1,serviceSearchText:null,services:null}],modelAlertChannel:{type:null,name:null,value:null,smtpReceivers:null},alertChannels:["Slack Webhook","SMTP"]}},computed:{filtersModelHostArray:function(){return this.filters.map((function(e){return e.modelHost}))},filtersModelServiceArray:function(){return this.filters.map((function(e){return e.modelService}))},selectionHostItems:function(){return["All"].concat(this.$store.getters.host_array)},firstHostModel:function(){return this.filters[0].modelHost},disableStep2:function(){return!this.ruleName},disableStep3:function(){return!this.filters[0].modelHost||!this.filters[0].modelService.length>0},disableSave:function(){return this.modelAlertChannel.type===this.alertChannels[1]?!this.modelAlertChannel.value||!this.modelAlertChannel.smtpReceivers:this.modelAlertChannel.type!==this.alertChannels[0]||!this.modelAlertChannel.value}},watch:{filtersModelHostArray:{handler:function(e,t){var n=this,a={item:null,index:-1};if(e.length>t.length)a.item=e[e.length-1],a.index=e.length-1;else if(e.length<t.length);else for(var s=0;s<e.length;s++){var o=e[s],r=t[s];if(o!==r){a.item=o,a.index=s;break}}if(console.warn("TabEditorAlertRule::watch::filtersModelHostArray - changed item:",JSON.stringify(a.item),"- at index:",a.index),"All"===a.item){this.filters[a.index].modelService=["All"],this.filters[a.index].disableService=!0;for(var i=0;i<this.filters.length;i++)i!==a.index&&this.filters.splice(i,1)}else a.item&&(this.filters[a.index].disableService=!1,l.a.get("".concat(this.$GCONFIG.api_base_url,"/api/hostnames/").concat(a.item,"/report")).then((function(e){console.log("TabEditorAlertRule::watch::filtersModelHostArray - API response:",e),e.data&&(n.filters[a.index].services=["All"].concat(e.data))})).catch((function(e){console.log("TabEditorAlertRule::watch::filtersModelHostArray - API error:",e)})))},deep:!0},filtersModelServiceArray:{handler:function(e){console.warn("TabEditorAlertRule::watch::filtersModelServiceArray - val:",JSON.stringify(e));for(var t=0;t<e.length;t++){var n=e[t];if(n){var a=n.indexOf("All");n.length>1&&a>-1&&(a===n.length-1?this.filters[t].modelService=["All"]:this.filters[t].modelService.splice(a,1))}}},deep:!0},"modelAlertChannel.type":function(e,t){console.log("modelAlertChannel type: newVal:",e," - oldVal:",t),e&&t&&(this.modelAlertChannel.name=null,this.modelAlertChannel.value=null,this.modelAlertChannel.smtpReceivers=null)}},created:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n,a,s,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("EDIT"!==e.mode){t.next=24;break}e.ruleName=e.alertRuleObject.name,e.modelAlertChannel=JSON.parse(e.alertRuleObject.alertConf),console.warn(e.alertRuleObject.filters),n=JSON.parse(e.alertRuleObject.filters),a=0;case 6:if(!(a<n.length)){t.next=24;break}return s=n[a],a===e.filters.length&&e.addEventFilter(),e.filters[a].modelHost=s.host,e.filters[a].modelService=s.services,t.prev=11,t.next=14,l.a.get("".concat(e.$GCONFIG.api_base_url,"/api/hostnames/").concat(s.host,"/report"));case 14:o=t.sent,o&&(console.log("TabEditorAlertRule::created() - edit mode - API response:",JSON.stringify(o.data)),o.data&&(e.filters[a].services=["All"].concat(o.data))),t.next=21;break;case 18:t.prev=18,t.t0=t["catch"](11),console.log("TabEditorAlertRule::created() - edit mode - API error:",t.t0);case 21:a++,t.next=6;break;case 24:case"end":return t.stop()}}),t,null,[[11,18]])})))()},methods:{addEventFilter:function(){this.filters.push({modelHost:null,modelService:[],disableService:!1,serviceSearchText:null,services:null})},removeEventFilter:function(e){console.log("TabEditorAlertRule::removeEventFilter() - with index:",e),this.filters.splice(e,1)},saveRule:function(){var e=this,t=[];this.filters.forEach((function(e){t.push({host:e.modelHost,services:e.modelService})}));var n=this.modelAlertChannel.value;"SMTP"===this.modelAlertChannel.type?this.$store.getters.smtp_alert_channel.forEach((function(t){t.id===n&&(e.modelAlertChannel.name=t.name)})):(this.modelAlertChannel.smtpReceivers=null,this.$store.getters.slack_iwh_alert_channel.forEach((function(t){t.id===n&&(e.modelAlertChannel.name=t.name)})));var a={name:this.ruleName,filters:JSON.stringify(t),alertConf:JSON.stringify(this.modelAlertChannel)};console.log("TabEditorAlertRule::saveRule() - requestObj:",a),"NEW"===this.mode?l.a.post("".concat(this.$GCONFIG.api_base_url,"/api/alert-rules"),a).then((function(t){console.log("TabEditorAlertRule::saveRule() - create response:",t),t.data&&("success"===t.data.status?(c["EventBus"].$emit("NEW_ALERT_RULE_INSERTED",Object(o["a"])({id:t.data.id},a)),e.$emit("closeDialog")):console.warn("TabEditorAlertRule::saveRule() - something is wrongs at backend when create"))})).catch((function(e){console.log("TabEditorAlertRule::saveRule() - create error:",e)})):l.a.put("".concat(this.$GCONFIG.api_base_url,"/api/alert-rules/").concat(this.alertRuleObject.id),a).then((function(t){console.log("TabEditorAlertRule::saveRule() - update response:",t),t.data&&("success"===t.data.status?(c["EventBus"].$emit("NEW_ALERT_RULE_UPDATED",Object(o["a"])({id:e.alertRuleObject.id},a)),e.$emit("closeDialog")):console.warn("TabEditorAlertRule::saveRule() - something is wrongs at backend when update"))})).catch((function(e){console.log("TabEditorAlertRule::saveRule() - update error:",e)}))}}},u=d,h=n("2877"),p=n("6544"),v=n.n(p),m=n("8336"),f=n("62ad"),b=n("2b5d"),_=n("a523"),g=n("169a"),C=n("ce7e"),x=n("4bd4"),y=n("132d"),S=n("da13"),w=n("5d23"),T=n("0fd9"),A=n("b974"),E=n("7e85"),k=n("e516"),O=n("9c54"),R=n("56a4"),D=n("8654"),V=n("a844"),L=Object(h["a"])(u,a,s,!1,null,null,null);t["default"]=L.exports;v()(L,{VBtn:m["a"],VCol:f["a"],VCombobox:b["a"],VContainer:_["a"],VDialog:g["a"],VDivider:C["a"],VForm:x["a"],VIcon:y["a"],VListItem:S["a"],VListItemContent:w["a"],VListItemTitle:w["c"],VRow:T["a"],VSelect:A["a"],VStepper:E["a"],VStepperContent:k["a"],VStepperHeader:O["a"],VStepperItems:O["b"],VStepperStep:R["a"],VTextField:D["a"],VTextarea:V["a"]})},dcc0:function(e,t,n){"use strict";var a=n("e659"),s=n.n(a);s.a},e659:function(e,t,n){}});
//# sourceMappingURL=app.de1ccd65.js.map